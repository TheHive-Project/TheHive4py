
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../alert/">
      
      
        <link rel="next" href="../../reference/">
      
      
      <link rel="icon" href="../../img/strangebee.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Case - thehive4py</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../styles/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#case" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="thehive4py" class="md-header__button md-logo" aria-label="thehive4py" data-md-component="logo">
      
  <img src="../../img/strangebee.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            thehive4py
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Case
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 2C5.13 2 2 5.13 2 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.87-3.13-7-7-7M6 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H6zm13-8h-2l-3.2 9h1.9l.7-2h3.2l.7 2h1.9zm-2.15 5.65L18 15l1.15 3.65z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/TheHive-Project/TheHive4py" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    TheHive-Project/TheHive4py
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  TheHive4py

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../client/" class="md-tabs__link">
          
  
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../reference/" class="md-tabs__link">
        
  
  
    
  
  Reference

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../release-notes/" class="md-tabs__link">
        
  
  
    
  
  Release Notes

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="thehive4py" class="md-nav__button md-logo" aria-label="thehive4py" data-md-component="logo">
      
  <img src="../../img/strangebee.png" alt="logo">

    </a>
    thehive4py
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/TheHive-Project/TheHive4py" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    TheHive-Project/TheHive4py
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TheHive4py
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../client/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Client
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../alert/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Alert
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Case
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Case
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#a-minimalistic-case" class="md-nav__link">
    <span class="md-ellipsis">
      A minimalistic case
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#an-advanced-case" class="md-nav__link">
    <span class="md-ellipsis">
      An advanced case
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#get-and-find" class="md-nav__link">
    <span class="md-ellipsis">
      Get and find
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Get and find">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-a-single-case" class="md-nav__link">
    <span class="md-ellipsis">
      Get a single case
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find-multiple-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Find multiple cases
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update-single-and-bulk" class="md-nav__link">
    <span class="md-ellipsis">
      Update single and bulk
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Update single and bulk">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#update-single" class="md-nav__link">
    <span class="md-ellipsis">
      Update single
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-bulk" class="md-nav__link">
    <span class="md-ellipsis">
      Update bulk
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#merge-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Merge cases
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#delete" class="md-nav__link">
    <span class="md-ellipsis">
      Delete
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#case-observables" class="md-nav__link">
    <span class="md-ellipsis">
      Case observables
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Case observables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-observables-to-an-existing-case" class="md-nav__link">
    <span class="md-ellipsis">
      Add observables to an existing case
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-file-based-observables" class="md-nav__link">
    <span class="md-ellipsis">
      Add file based observables
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#case-tasks" class="md-nav__link">
    <span class="md-ellipsis">
      Case tasks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Case tasks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-tasks-during-case-creation" class="md-nav__link">
    <span class="md-ellipsis">
      Add tasks during case creation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-tasks-to-an-existing-case" class="md-nav__link">
    <span class="md-ellipsis">
      Add tasks to an existing case
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#case-pages" class="md-nav__link">
    <span class="md-ellipsis">
      Case pages
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Case pages">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-pages-during-case-creation" class="md-nav__link">
    <span class="md-ellipsis">
      Add pages during case creation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-pages-to-an-existing-case" class="md-nav__link">
    <span class="md-ellipsis">
      Add pages to an existing case
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#case-procedures" class="md-nav__link">
    <span class="md-ellipsis">
      Case procedures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Case procedures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-procedures-to-an-existing-case" class="md-nav__link">
    <span class="md-ellipsis">
      Add procedures to an existing case
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../release-notes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Release Notes
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#a-minimalistic-case" class="md-nav__link">
    <span class="md-ellipsis">
      A minimalistic case
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#an-advanced-case" class="md-nav__link">
    <span class="md-ellipsis">
      An advanced case
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#get-and-find" class="md-nav__link">
    <span class="md-ellipsis">
      Get and find
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Get and find">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-a-single-case" class="md-nav__link">
    <span class="md-ellipsis">
      Get a single case
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find-multiple-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Find multiple cases
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update-single-and-bulk" class="md-nav__link">
    <span class="md-ellipsis">
      Update single and bulk
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Update single and bulk">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#update-single" class="md-nav__link">
    <span class="md-ellipsis">
      Update single
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-bulk" class="md-nav__link">
    <span class="md-ellipsis">
      Update bulk
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#merge-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Merge cases
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#delete" class="md-nav__link">
    <span class="md-ellipsis">
      Delete
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#case-observables" class="md-nav__link">
    <span class="md-ellipsis">
      Case observables
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Case observables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-observables-to-an-existing-case" class="md-nav__link">
    <span class="md-ellipsis">
      Add observables to an existing case
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-file-based-observables" class="md-nav__link">
    <span class="md-ellipsis">
      Add file based observables
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#case-tasks" class="md-nav__link">
    <span class="md-ellipsis">
      Case tasks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Case tasks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-tasks-during-case-creation" class="md-nav__link">
    <span class="md-ellipsis">
      Add tasks during case creation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-tasks-to-an-existing-case" class="md-nav__link">
    <span class="md-ellipsis">
      Add tasks to an existing case
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#case-pages" class="md-nav__link">
    <span class="md-ellipsis">
      Case pages
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Case pages">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-pages-during-case-creation" class="md-nav__link">
    <span class="md-ellipsis">
      Add pages during case creation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-pages-to-an-existing-case" class="md-nav__link">
    <span class="md-ellipsis">
      Add pages to an existing case
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#case-procedures" class="md-nav__link">
    <span class="md-ellipsis">
      Case procedures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Case procedures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-procedures-to-an-existing-case" class="md-nav__link">
    <span class="md-ellipsis">
      Add procedures to an existing case
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="case">Case</h1>
<h2 id="a-minimalistic-case">A minimalistic case</h2>
<p>The most minimalistic case requires at least the below fields to be defined:</p>
<ul>
<li><code>title</code>: The title of the case.</li>
<li><code>description</code>: The description of the case.</li>
</ul>
<p>Here's an example that demonstrates how to create the most minimalistic case possible using the <a class="autorefs autorefs-internal" title="            create(case)" href="../../reference/#thehive4py.endpoints.case.CaseEndpoint.create">case.create</a> method:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">thehive4py</span><span class="w"> </span><span class="kn">import</span> <span class="n">TheHiveApi</span>

<span class="n">hive</span> <span class="o">=</span> <span class="n">TheHiveApi</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://localhost:9000&quot;</span><span class="p">,</span> <span class="n">apikey</span><span class="o">=</span><span class="s2">&quot;h1v3b33&quot;</span><span class="p">)</span>

<span class="n">minimalistic_case</span> <span class="o">=</span> <span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">case</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;a minimalistic case&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a bit too minimal&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>
</code></pre></div>
<h2 id="an-advanced-case">An advanced case</h2>
<p>The previous example demonstrated how to create the simplest case ever.</p>
<p>In the next example let's create a more advanced case by using the combination of the <a class="autorefs autorefs-internal" title="            InputCase" href="../../reference/#thehive4py.types.case.InputCase">InputCase</a> type hint and the <a class="autorefs autorefs-internal" title="            create(case)" href="../../reference/#thehive4py.endpoints.case.CaseEndpoint.create">case.create</a> method.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">thehive4py</span><span class="w"> </span><span class="kn">import</span> <span class="n">TheHiveApi</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">thehive4py.types.case</span><span class="w"> </span><span class="kn">import</span> <span class="n">InputCase</span>

<span class="n">hive</span> <span class="o">=</span> <span class="n">TheHiveApi</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://localhost:9000&quot;</span><span class="p">,</span> <span class="n">apikey</span><span class="o">=</span><span class="s2">&quot;h1v3b33&quot;</span><span class="p">)</span>

<span class="n">input_case</span><span class="p">:</span> <span class="n">InputCase</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;an advanced case&quot;</span><span class="p">,</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a bit more advanced case...&quot;</span><span class="p">,</span>
    <span class="s2">&quot;caseTemplate&quot;</span><span class="p">:</span> <span class="s2">&quot;my-template&quot;</span><span class="p">,</span>
    <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;New&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;advanced&quot;</span><span class="p">,</span> <span class="s2">&quot;example&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">output_case</span> <span class="o">=</span> <span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">case</span><span class="o">=</span><span class="n">input_case</span><span class="p">)</span>
</code></pre></div>
<p>In the above snippet <code>input_case</code> is created before the create call and later passed to the <code>case</code> argument.</p>
<p>Finally after the creation of the case we saved the response in the <code>output_case</code> to be able to use it later.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While the above case is a bit more advanced it's still far from the most complex example that is possible. 
Should you be interested of what the Case API offers please check out the <a href="https://docs.strangebee.com/thehive/api-docs/#tag/Case">official docs</a>.</p>
</div>
<h2 id="get-and-find">Get and find</h2>
<p>There are multiple ways to retrieve already existing cases:</p>
<h3 id="get-a-single-case">Get a single case</h3>
<p>To get a single case one can use the <a class="autorefs autorefs-internal" title="            get(case_id)" href="../../reference/#thehive4py.endpoints.case.CaseEndpoint.get">case.get</a> method with the case's id as follows:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">thehive4py</span><span class="w"> </span><span class="kn">import</span> <span class="n">TheHiveApi</span>

<span class="n">hive</span> <span class="o">=</span> <span class="n">TheHiveApi</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://localhost:9000&quot;</span><span class="p">,</span> <span class="n">apikey</span><span class="o">=</span><span class="s2">&quot;h1v3b33&quot;</span><span class="p">)</span>

<span class="n">case_to_get</span> <span class="o">=</span> <span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">case</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;case to get&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a single case to fetch&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>


<span class="n">fetched_case</span> <span class="o">=</span> <span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">case_id</span><span class="o">=</span><span class="n">case_to_get</span><span class="p">[</span><span class="s2">&quot;_id&quot;</span><span class="p">])</span>
</code></pre></div>
<h3 id="find-multiple-cases">Find multiple cases</h3>
<p>To fetch multiple cases based on arbitrary conditions one can use the <a class="autorefs autorefs-internal" title="            find(filters=None, sortby=None, paginate=None)" href="../../reference/#thehive4py.endpoints.case.CaseEndpoint.find">case.find</a> method which is an abstraction on top of TheHive's Query API.</p>
<p>In the next example we will create two cases with different tags. The first case will get the <code>antivirus</code> tag while the second one will get the <code>phishing</code> tag.</p>
<p>Then we will construct a query filter that will look for cases with these tags on them:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">thehive4py</span><span class="w"> </span><span class="kn">import</span> <span class="n">TheHiveApi</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">thehive4py.query.filters</span><span class="w"> </span><span class="kn">import</span> <span class="n">Eq</span>

<span class="n">hive</span> <span class="o">=</span> <span class="n">TheHiveApi</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://localhost:9000&quot;</span><span class="p">,</span> <span class="n">apikey</span><span class="o">=</span><span class="s2">&quot;h1v3b33&quot;</span><span class="p">)</span>

<span class="n">antivirus_case</span> <span class="o">=</span> <span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">case</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;case #1 to find&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a case to find with others&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;antivirus&quot;</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">phishing_case</span> <span class="o">=</span> <span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">case</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;case #2 to find&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a case to find with others&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;phishing&quot;</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>


<span class="n">filters</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s2">&quot;tags&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;antivirus&quot;</span><span class="p">)</span> <span class="o">|</span> <span class="n">Eq</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s2">&quot;tags&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;phishing&quot;</span><span class="p">)</span>
<span class="n">fetched_cases</span> <span class="o">=</span> <span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>
</code></pre></div>
<p>The above example demonstrates how to construct query filters.</p>
<p>These filter expressions can be chained together with different operators, just like we did with the <code>|</code> (<code>or</code>) operator in the example.</p>
<p>Currently, the filter classes support the following operators:</p>
<ul>
<li><code>&amp;</code>: Used for the Query API's <code>_and</code> construct.</li>
<li><code>|</code>: Used for the Query API's <code>_or</code> construct.</li>
<li><code>~</code>: Used for the Query API's <code>_not</code> construct.</li>
</ul>
<p>The full list of the filter builders can be found in the <a class="autorefs autorefs-internal" title="            filters" href="../../reference/#thehive4py.query.filters">query.filters</a> module.</p>
<h2 id="update-single-and-bulk">Update single and bulk</h2>
<p>Sometimes an existing case needs to be updated. TheHive offers multiple ways to accomplish this task either with a single case or multiple ones.</p>
<h3 id="update-single">Update single</h3>
<p>A single case can be updated using <a class="autorefs autorefs-internal" title="            update(case_id, fields={}, **kwargs)" href="../../reference/#thehive4py.endpoints.case.CaseEndpoint.update">case.update</a> method. The method requires the <code>case_id</code> of the case to be updated and the <code>fields</code> to update.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">thehive4py</span><span class="w"> </span><span class="kn">import</span> <span class="n">TheHiveApi</span>

<span class="n">hive</span> <span class="o">=</span> <span class="n">TheHiveApi</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://localhost:9000&quot;</span><span class="p">,</span> <span class="n">apikey</span><span class="o">=</span><span class="s2">&quot;h1v3b33&quot;</span><span class="p">)</span>

<span class="n">original_case</span> <span class="o">=</span> <span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">case</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;original case&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a single case to update&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>


<span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
    <span class="n">case_id</span><span class="o">=</span><span class="n">original_case</span><span class="p">[</span><span class="s2">&quot;_id&quot;</span><span class="p">],</span>
    <span class="n">fields</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;updated case&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;update-single&quot;</span><span class="p">],</span>
    <span class="p">},</span>
<span class="p">)</span>

<span class="n">updated_case</span> <span class="o">=</span> <span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">case_id</span><span class="o">=</span><span class="n">original_case</span><span class="p">[</span><span class="s2">&quot;_id&quot;</span><span class="p">])</span>
</code></pre></div>
<p>In the above example we've updated the <code>title</code> and the <code>tags</code> fields.</p>
<p>Be mindful though, <code>thehive4py</code> is a lightweight wrapper around TheHive API and offers no object relationship mapping functionalities, meaning that the original <code>original_case</code> won't reflect the changes of the update.</p>
<p>To work with the updated case we fetched the latest version using the <a class="autorefs autorefs-internal" title="            get(case_id)" href="../../reference/#thehive4py.endpoints.case.CaseEndpoint.get">case.get</a> method and stored it in the <code>updated_case</code> variable.</p>
<p>Now the content of <code>updated_case</code> should reflect the changes we made with our update request.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To see the full list of supported update fields please consult the <a href="https://docs.strangebee.com/thehive/api-docs/#tag/Case/operation/Update%20case">official docs</a>.</p>
</div>
<h3 id="update-bulk">Update bulk</h3>
<p>To update the <strong>same fields</strong> with the <strong>same values</strong> on multiple cases at the same time, one can use <a class="autorefs autorefs-internal" title="            bulk_update(fields)" href="../../reference/#thehive4py.endpoints.case.CaseEndpoint.bulk_update">case.bulk_update</a> method. 
The method accepts the same <code>fields</code> dictionary with an additional <code>ids</code> field on it, which should contain the list of ids of the cases to be bulk updated.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">thehive4py</span><span class="w"> </span><span class="kn">import</span> <span class="n">TheHiveApi</span>

<span class="n">hive</span> <span class="o">=</span> <span class="n">TheHiveApi</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://localhost:9000&quot;</span><span class="p">,</span> <span class="n">apikey</span><span class="o">=</span><span class="s2">&quot;h1v3b33&quot;</span><span class="p">)</span>

<span class="n">original_case_ids</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">original_case</span> <span class="o">=</span> <span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
        <span class="n">case</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;original case #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a case to update in bulk&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="n">original_case_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">original_case</span><span class="p">[</span><span class="s2">&quot;_id&quot;</span><span class="p">])</span>


<span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">bulk_update</span><span class="p">(</span>
    <span class="n">fields</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;ids&quot;</span><span class="p">:</span> <span class="n">original_case_ids</span><span class="p">,</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;bulk updated case&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;update-bulk&quot;</span><span class="p">],</span>
    <span class="p">},</span>
<span class="p">)</span>
</code></pre></div>
<p>In the example we prepare two cases for the bulk update, and collect their ids in the <code>original_case_ids</code> list.
Then we update the fields <code>title</code> and <code>tags</code> on both cases using the bulk update method.</p>
<h2 id="merge-cases">Merge cases</h2>
<p>Many times during case triaging it occurs that individual cases turn out to be closely related. For this use case TheHive provides an option to merge individual cases using the <a class="autorefs autorefs-internal" title="            merge(case_ids)" href="../../reference/#thehive4py.endpoints.case.CaseEndpoint.merge">case.merge</a> method.</p>
<p>In the following example we will create two cases and will merge them into one new case:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">thehive4py</span><span class="w"> </span><span class="kn">import</span> <span class="n">TheHiveApi</span>

<span class="n">hive</span> <span class="o">=</span> <span class="n">TheHiveApi</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://localhost:9000&quot;</span><span class="p">,</span> <span class="n">apikey</span><span class="o">=</span><span class="s2">&quot;h1v3b33&quot;</span><span class="p">)</span>

<span class="n">case_ids_to_merge</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">case_to_merge</span> <span class="o">=</span> <span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
        <span class="n">case</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;original case #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a case to merge with another&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="n">case_ids_to_merge</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">case_to_merge</span><span class="p">[</span><span class="s2">&quot;_id&quot;</span><span class="p">])</span>


<span class="n">merge_case</span> <span class="o">=</span> <span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">case_ids</span><span class="o">=</span><span class="n">case_ids_to_merge</span><span class="p">)</span>
</code></pre></div>
<p>As you can see the merged cases will end up in one single case which is represented by the <code>merge_case</code> variable in our example.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In case you wonder what will happen to the original cases, during the merge they will be deleted and their legacy will live on in the final merge case.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the example we merged two cases, but it's worth to mention that the merge endpoint lets us merge as many cases as we need into one final case.</p>
</div>
<h2 id="delete">Delete</h2>
<p>It's possible to delete a case using the <a class="autorefs autorefs-internal" title="            delete(case_id)" href="../../reference/#thehive4py.endpoints.case.CaseEndpoint.delete">case.delete</a> method.
Here's a simple example to demonstrate: </p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">thehive4py</span><span class="w"> </span><span class="kn">import</span> <span class="n">TheHiveApi</span>

<span class="n">hive</span> <span class="o">=</span> <span class="n">TheHiveApi</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://localhost:9000&quot;</span><span class="p">,</span> <span class="n">apikey</span><span class="o">=</span><span class="s2">&quot;h1v3b33&quot;</span><span class="p">)</span>

<span class="n">case_to_delete</span> <span class="o">=</span> <span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">case</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;delete case&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;an case to delete&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>


<span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">case_id</span><span class="o">=</span><span class="n">case_to_delete</span><span class="p">[</span><span class="s2">&quot;_id&quot;</span><span class="p">])</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In contrast to the alert endpoint the case endpoint doesn't support bulk deletion of cases, so should you need to delete multiple cases the easiest options is to collect the case ids and iterate over them using the single delete endpoint.</p>
</div>
<h2 id="case-observables">Case observables</h2>
<p>TheHive API provides multiple ways to add observables to cases, let them be textual or file based observables.</p>
<h3 id="add-observables-to-an-existing-case">Add observables to an existing case</h3>
<p>Unlike the Alert API, the Case API doesn't support adding observables to cases during their creation, this means that we can only add case observables retroactively.</p>
<p>In the next example we're gonna create a case to add two observables to it using the <a class="autorefs autorefs-internal" title="            create_observable(case_id, observable, observable_path=None)" href="../../reference/#thehive4py.endpoints.case.CaseEndpoint.create_observable">case.create_observable</a> method:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">thehive4py</span><span class="w"> </span><span class="kn">import</span> <span class="n">TheHiveApi</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">thehive4py.types.observable</span><span class="w"> </span><span class="kn">import</span> <span class="n">InputObservable</span>

<span class="n">hive</span> <span class="o">=</span> <span class="n">TheHiveApi</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;thehive.example&quot;</span><span class="p">,</span> <span class="n">apikey</span><span class="o">=</span><span class="s2">&quot;h1v3b33&quot;</span><span class="p">)</span>


<span class="n">case_to_enrich</span> <span class="o">=</span> <span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">case</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;case to enrich&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a case to enrich with simple observables&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>


<span class="n">observables</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">InputObservable</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">&quot;dataType&quot;</span><span class="p">:</span> <span class="s2">&quot;ip&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;1.2.3.4&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;dataType&quot;</span><span class="p">:</span> <span class="s2">&quot;domain&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;example.com&quot;</span><span class="p">},</span>
<span class="p">]</span>


<span class="k">for</span> <span class="n">observable</span> <span class="ow">in</span> <span class="n">observables</span><span class="p">:</span>
    <span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">create_observable</span><span class="p">(</span><span class="n">case_id</span><span class="o">=</span><span class="n">case_to_enrich</span><span class="p">[</span><span class="s2">&quot;_id&quot;</span><span class="p">],</span> <span class="n">observable</span><span class="o">=</span><span class="n">observable</span><span class="p">)</span>
</code></pre></div>
<h3 id="add-file-based-observables">Add file based observables</h3>
<p>In the previous example we've seen how to handle simple observables without attachments. Next we will create a temporary directory with a dummy file and some dummy content that will represent our file based observable and add it to a case:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">os.path</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">thehive4py</span><span class="w"> </span><span class="kn">import</span> <span class="n">TheHiveApi</span>

<span class="n">hive</span> <span class="o">=</span> <span class="n">TheHiveApi</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://localhost:9000&quot;</span><span class="p">,</span> <span class="n">apikey</span><span class="o">=</span><span class="s2">&quot;h1v3b33&quot;</span><span class="p">)</span>

<span class="n">case_to_enrich</span> <span class="o">=</span> <span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">case</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;case to enrich&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a case to enrich with a file observable&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdir</span><span class="p">:</span>

    <span class="n">observable_filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdir</span><span class="p">,</span> <span class="s2">&quot;my-observable.txt&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">observable_filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">observable_file</span><span class="p">:</span>
        <span class="n">observable_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;some observable content&quot;</span><span class="p">)</span>

    <span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">create_observable</span><span class="p">(</span>
        <span class="n">case_id</span><span class="o">=</span><span class="n">case_to_enrich</span><span class="p">[</span><span class="s2">&quot;_id&quot;</span><span class="p">],</span>
        <span class="n">observable</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;dataType&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;a file based observable&quot;</span><span class="p">},</span>
        <span class="n">observable_path</span><span class="o">=</span><span class="n">observable_filepath</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
<p>As we can see from the above example a file based observable needs an actual file and its filepath, in our example these are represented by <code>observable_filepath</code> and <code>observable_file</code></p>
<p>Finally the <code>observable</code> metadata needs to be defined with its <code>dataType</code> as <code>file</code> and then the <code>data</code> field should be omitted. Finally the <code>observable_path</code> argument must be defined with the value of the actual <code>observable_filepath</code>.</p>
<p>This way TheHive will pair the observable metadata with the file as its attachment behind the scenes.</p>
<h2 id="case-tasks">Case tasks</h2>
<p>For more advanced case handling we can specify tasks which will serve as steps during the evaluation of the case.</p>
<p>Fortunately TheHive API provides different options to add tasks to cases and we will check them out in the next sections.</p>
<h3 id="add-tasks-during-case-creation">Add tasks during case creation</h3>
<p>We can specify tasks already during case creation. This is a great way to combine case and task creation in an atomic way.</p>
<p>Let's do an example to create a case with a <code>Triage</code> and <code>Respond</code> tasks:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">thehive4py</span><span class="w"> </span><span class="kn">import</span> <span class="n">TheHiveApi</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">thehive4py.types.task</span><span class="w"> </span><span class="kn">import</span> <span class="n">InputTask</span>

<span class="n">hive</span> <span class="o">=</span> <span class="n">TheHiveApi</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;thehive.example&quot;</span><span class="p">,</span> <span class="n">apikey</span><span class="o">=</span><span class="s2">&quot;h1v3b33&quot;</span><span class="p">)</span>


<span class="n">case_tasks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">InputTask</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Triage&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Conduct the initial investigation&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Respond&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Execute the required actions&quot;</span><span class="p">},</span>
<span class="p">]</span>

<span class="n">case_with_tasks</span> <span class="o">=</span> <span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">case</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;case with tasks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a case enriched with tasks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tasks&quot;</span><span class="p">:</span> <span class="n">case_tasks</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>
</code></pre></div>
<p>This snippet will create a case with the required tasks in one go.</p>
<h3 id="add-tasks-to-an-existing-case">Add tasks to an existing case</h3>
<p>In the previous section we could see that it's possible to specify tasks during case creation, however sometimes we want to add tasks after a case has been created.</p>
<p>For this purpose we can use the <a class="autorefs autorefs-internal" title="            create_task(case_id, task)" href="../../reference/#thehive4py.endpoints.case.CaseEndpoint.create_task">case.create_task</a> method.</p>
<p>Now let's do an example by adding tasks retroactively to a case:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">thehive4py</span><span class="w"> </span><span class="kn">import</span> <span class="n">TheHiveApi</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">thehive4py.types.task</span><span class="w"> </span><span class="kn">import</span> <span class="n">InputTask</span>

<span class="n">hive</span> <span class="o">=</span> <span class="n">TheHiveApi</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;thehive.example&quot;</span><span class="p">,</span> <span class="n">apikey</span><span class="o">=</span><span class="s2">&quot;h1v3b33&quot;</span><span class="p">)</span>


<span class="n">case_to_enrich</span> <span class="o">=</span> <span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">case</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;case to enrich&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a case to enrich with tasks&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">case_tasks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">InputTask</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Summarize&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Summarize the investigation&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Report&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Create a report for the CISO&quot;</span><span class="p">},</span>
<span class="p">]</span>


<span class="k">for</span> <span class="n">case_task</span> <span class="ow">in</span> <span class="n">case_tasks</span><span class="p">:</span>
    <span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">case_id</span><span class="o">=</span><span class="n">case_to_enrich</span><span class="p">[</span><span class="s2">&quot;_id&quot;</span><span class="p">],</span> <span class="n">task</span><span class="o">=</span><span class="n">case_task</span><span class="p">)</span>
</code></pre></div>
<p>In the above example we created an empty case as <code>case_to_enrich</code>, and then defined a list of two tasks in the <code>case_tasks</code> variable.</p>
<p>Finally using a for loop and the <code>case.create_task</code> method we added them to our dummy case one by one.</p>
<h2 id="case-pages">Case pages</h2>
<p>In order to give more context to a case we can add pages to it, which could serve as additional notes or documentation during investigation.</p>
<p>Like usual TheHive API provides different possibilities to add such pages to cases that we will see in the next sections.</p>
<h3 id="add-pages-during-case-creation">Add pages during case creation</h3>
<p>We can add pages already during case creation. This is a great way to combine case and page creation in a single go.</p>
<p>Let's create a case with two pages, one to take notes and another one to summarize the case:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">thehive4py</span><span class="w"> </span><span class="kn">import</span> <span class="n">TheHiveApi</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">thehive4py.types.page</span><span class="w"> </span><span class="kn">import</span> <span class="n">InputCasePage</span>

<span class="n">hive</span> <span class="o">=</span> <span class="n">TheHiveApi</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;thehive.example&quot;</span><span class="p">,</span> <span class="n">apikey</span><span class="o">=</span><span class="s2">&quot;h1v3b33&quot;</span><span class="p">)</span>


<span class="n">case_pages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">InputCasePage</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Notes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
        <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Some notes to take during case triage.&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Summary&quot;</span><span class="p">,</span>
        <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
        <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Some summary to wrap up the case triage.&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">]</span>

<span class="n">case_with_tasks</span> <span class="o">=</span> <span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">case</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;case with tasks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a case enriched with tasks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pages&quot;</span><span class="p">:</span> <span class="n">case_pages</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>
</code></pre></div>
<p>As you can see we had to specify the <code>title</code>, <code>category</code> and <code>content</code> fields which are all mandatory for the page objects.</p>
<p>On the other hand each of these fields are freetext fields so we have the freedom to specify any value for them.</p>
<h3 id="add-pages-to-an-existing-case">Add pages to an existing case</h3>
<p>In the previous section we could see that it's possible to add pages during case creation, however sometimes we want to add pages after a case has been created.</p>
<p>For this purpose we can use the <a class="autorefs autorefs-internal" title="            create_page(case_id, page)" href="../../reference/#thehive4py.endpoints.case.CaseEndpoint.create_page">case.create_page</a> method.</p>
<p>Now let's do an example by adding pages retroactively to a case:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">thehive4py</span><span class="w"> </span><span class="kn">import</span> <span class="n">TheHiveApi</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">thehive4py.types.page</span><span class="w"> </span><span class="kn">import</span> <span class="n">InputCasePage</span>

<span class="n">hive</span> <span class="o">=</span> <span class="n">TheHiveApi</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;thehive.example&quot;</span><span class="p">,</span> <span class="n">apikey</span><span class="o">=</span><span class="s2">&quot;h1v3b33&quot;</span><span class="p">)</span>


<span class="n">case_to_enrich</span> <span class="o">=</span> <span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">case</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;case to enrich&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a case to enrich with pages&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">case_pages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">InputCasePage</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Playbooks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;general&quot;</span><span class="p">,</span>
        <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Some playbook content&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Resources&quot;</span><span class="p">,</span>
        <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;general&quot;</span><span class="p">,</span>
        <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Some useful resources&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">]</span>


<span class="k">for</span> <span class="n">case_page</span> <span class="ow">in</span> <span class="n">case_pages</span><span class="p">:</span>
    <span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">create_page</span><span class="p">(</span><span class="n">case_id</span><span class="o">=</span><span class="n">case_to_enrich</span><span class="p">[</span><span class="s2">&quot;_id&quot;</span><span class="p">],</span> <span class="n">page</span><span class="o">=</span><span class="n">case_page</span><span class="p">)</span>
</code></pre></div>
<p>In the above example we created an empty case as <code>case_to_enrich</code>, and then defined a list of pages in the <code>page_tasks</code> variable.</p>
<p>Finally using a for loop and the <code>case.create_page</code> method we added them to our dummy case one by one.</p>
<h2 id="case-procedures">Case procedures</h2>
<p>TheHive considers the <a href="https://attack.mitre.org/">MITRE ATT&amp;CK</a> framework as a first class citizen and fully supports its tactics, techniques and procedures (TTPs for short), therefore it's possible to enrich cases with procedures from their catalog.</p>
<p>TheHive simply refers to the MITRE ATT&amp;CK TTPs as procedures, and next we will see how can these procedures be applied to cases.</p>
<h3 id="add-procedures-to-an-existing-case">Add procedures to an existing case</h3>
<p>In this example we will create an empty case and using the <a class="autorefs autorefs-internal" title="            create_task(case_id, task)" href="../../reference/#thehive4py.endpoints.case.CaseEndpoint.create_task">case.create_task</a> method we will enrich it with the technique of <a href="https://attack.mitre.org/techniques/T1566/">[T1566] Phishing</a> and the subtechnique of <a href="https://attack.mitre.org/techniques/T1566/001/">[T1566.001] Phishing - Spearphishing Attachment</a>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">thehive4py</span><span class="w"> </span><span class="kn">import</span> <span class="n">TheHiveApi</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">thehive4py.helpers</span><span class="w"> </span><span class="kn">import</span> <span class="n">now_to_ts</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">thehive4py.types.procedure</span><span class="w"> </span><span class="kn">import</span> <span class="n">InputProcedure</span>

<span class="n">hive</span> <span class="o">=</span> <span class="n">TheHiveApi</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;thehive.example&quot;</span><span class="p">,</span> <span class="n">apikey</span><span class="o">=</span><span class="s2">&quot;h1v3b33&quot;</span><span class="p">)</span>

<span class="n">case_to_enrich</span> <span class="o">=</span> <span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">case</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;case to enrich&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a case to enrich with procedures&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">case_procedures</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">InputProcedure</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;occurDate&quot;</span><span class="p">:</span> <span class="n">now_to_ts</span><span class="p">(),</span>
        <span class="s2">&quot;patternId&quot;</span><span class="p">:</span> <span class="s2">&quot;T1566&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tactic&quot;</span><span class="p">:</span> <span class="s2">&quot;initial-access&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Phishing&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;occurDate&quot;</span><span class="p">:</span> <span class="n">now_to_ts</span><span class="p">(),</span>
        <span class="s2">&quot;patternId&quot;</span><span class="p">:</span> <span class="s2">&quot;T1566.001&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tactic&quot;</span><span class="p">:</span> <span class="s2">&quot;initial-access&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Spearphishing Attachment&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">]</span>


<span class="k">for</span> <span class="n">procedure</span> <span class="ow">in</span> <span class="n">case_procedures</span><span class="p">:</span>
    <span class="n">hive</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">create_procedure</span><span class="p">(</span><span class="n">case_id</span><span class="o">=</span><span class="n">case_to_enrich</span><span class="p">[</span><span class="s2">&quot;_id&quot;</span><span class="p">],</span> <span class="n">procedure</span><span class="o">=</span><span class="n">procedure</span><span class="p">)</span>
</code></pre></div>
<p>The procedure entity requires <code>occurDate</code> and <code>patternId</code> as they are mandatory fields while <code>tactic</code> and <code>description</code> are optional.</p>
<p>To simplify the example we also used the <a class="autorefs autorefs-internal" title="            now_to_ts()" href="../../reference/#thehive4py.helpers.now_to_ts">helpers.now_to_ts</a> function to generate a dummy timestamp for the procedures.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../alert/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Alert">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Alert
              </div>
            </div>
          </a>
        
        
          
          <a href="../../reference/" class="md-footer__link md-footer__link--next" aria-label="Next: Reference">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Reference
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://discord.com/invite/XhxG3vzM44" target="_blank" rel="noopener" title="Discord" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.317 4.37a19.8 19.8 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.3 18.3 0 0 0-5.487 0 13 13 0 0 0-.617-1.25.08.08 0 0 0-.079-.037A19.7 19.7 0 0 0 3.677 4.37a.1.1 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.08.08 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.08.08 0 0 0 .084-.028c.462-.63.874-1.295 1.226-1.994a.076.076 0 0 0-.041-.106 13 13 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10 10 0 0 0 .372-.292.07.07 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.07.07 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.3 12.3 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.08.08 0 0 0 .084.028 19.8 19.8 0 0 0 6.002-3.03.08.08 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.06.06 0 0 0-.031-.03M8.02 15.33c-1.182 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418m7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418"/></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/TheHive-Project/TheHive4py" target="_blank" rel="noopener" title="GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
    </a>
  
    
    
    
    
    <a href="https://pypi.org/project/thehive4py/" target="_blank" rel="noopener" title="PyPI" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.25.18.9.2.73.26.59.3.45.32.34.34.25.34.16.33.1.3.04.26.02.2-.01.13V8.5l-.05.63-.13.55-.21.46-.26.38-.3.31-.33.25-.35.19-.35.14-.33.1-.3.07-.26.04-.21.02H8.77l-.69.05-.59.14-.5.22-.41.27-.33.32-.27.35-.2.36-.15.37-.1.35-.07.32-.04.27-.02.21v3.06H3.17l-.21-.03-.28-.07-.32-.12-.35-.18-.36-.26-.36-.36-.35-.46-.32-.59-.28-.73-.21-.88-.14-1.05-.05-1.23.06-1.22.16-1.04.24-.87.32-.71.36-.57.4-.44.42-.33.42-.24.4-.16.36-.1.32-.05.24-.01h.16l.06.01h8.16v-.83H6.18l-.01-2.75-.02-.37.05-.34.11-.31.17-.28.25-.26.31-.23.38-.2.44-.18.51-.15.58-.12.64-.1.71-.06.77-.04.84-.02 1.27.05zm-6.3 1.98-.23.33-.08.41.08.41.23.34.33.22.41.09.41-.09.33-.22.23-.34.08-.41-.08-.41-.23-.33-.33-.22-.41-.09-.41.09zm13.09 3.95.28.06.32.12.35.18.36.27.36.35.35.47.32.59.28.73.21.88.14 1.04.05 1.23-.06 1.23-.16 1.04-.24.86-.32.71-.36.57-.4.45-.42.33-.42.24-.4.16-.36.09-.32.05-.24.02-.16-.01h-8.22v.82h5.84l.01 2.76.02.36-.05.34-.11.31-.17.29-.25.25-.31.24-.38.2-.44.17-.51.15-.58.13-.64.09-.71.07-.77.04-.84.01-1.27-.04-1.07-.14-.9-.2-.73-.25-.59-.3-.45-.33-.34-.34-.25-.34-.16-.33-.1-.3-.04-.25-.02-.2.01-.13v-5.34l.05-.64.13-.54.21-.46.26-.38.3-.32.33-.24.35-.2.35-.14.33-.1.3-.06.26-.04.21-.02.13-.01h5.84l.69-.05.59-.14.5-.21.41-.28.33-.32.27-.35.2-.36.15-.36.1-.35.07-.32.04-.28.02-.21V6.07h2.09l.14.01zm-6.47 14.25-.23.33-.08.41.08.41.23.33.33.23.41.08.41-.08.33-.23.23-.33.08-.41-.08-.41-.23-.33-.33-.23-.41-.08-.41.08z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "navigation.footer", "navigation.tabs", "navigation.tabs.sticky", "toc.follow"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>