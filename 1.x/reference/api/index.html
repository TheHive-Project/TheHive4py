
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://thehive-project.github.io/thehive4py/reference/api/" rel="canonical"/>
<link href="../../assets/images/favicon.png" rel="shortcut icon"/>
<meta content="mkdocs-1.1.2, mkdocs-material-5.2.2" name="generator"/>
<title>API - TheHive4py Documentation</title>
<link href="../../assets/stylesheets/main.a2408e81.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.a46bcfb3.min.css" rel="stylesheet"/>
<meta content="#2196f3" name="theme-color"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
<link href="../../custom.css" rel="stylesheet"/>
</head>
<body data-md-color-accent="blue" data-md-color-primary="blue" data-md-color-scheme="" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#api">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header-nav md-grid">
<a aria-label="TheHive4py Documentation" class="md-header-nav__button md-logo" href="https://thehive-project.github.io/thehive4py" title="TheHive4py Documentation">
<img alt="logo" src="../../images/thehive.png"/>
</a>
<label class="md-header-nav__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header-nav__title" data-md-component="header-title">
<div class="md-header-nav__ellipsis">
<span class="md-header-nav__topic md-ellipsis">
            TheHive4py Documentation
          </span>
<span class="md-header-nav__topic md-ellipsis">
            
              API
            
          </span>
</div>
</div>
<label class="md-header-nav__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" data-md-state="active" name="query" placeholder="Search" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<button aria-label="Clear" class="md-search__icon md-icon" data-md-component="search-reset" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header-nav__source">
<a class="md-source" href="https://github.com/TheHive-Project/TheHive4py/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    TheHive-Project/TheHive4py
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="TheHive4py Documentation" class="md-nav__button md-logo" href="https://thehive-project.github.io/thehive4py" title="TheHive4py Documentation">
<img alt="logo" src="../../images/thehive.png"/>
</a>
    TheHive4py Documentation
  </label>
<div class="md-nav__source">
<a class="md-source" href="https://github.com/TheHive-Project/TheHive4py/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    TheHive-Project/TheHive4py
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../.." title="TheHive4py">
      TheHive4py
    </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="nav-2" id="nav-2" type="checkbox"/>
<label class="md-nav__link" for="nav-2">
      Reference
      <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg>
</span>
</label>
<nav aria-label="Reference" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="nav-2">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
        Reference
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../models/" title="Models">
      Models
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../auth/" title="Auth">
      Auth
    </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
        API
        <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"></path></svg>
</span>
</label>
<a class="md-nav__link md-nav__link--active" href="./" title="API">
      API
    </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api">
    thehive4py.api
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi">
    TheHiveApi
  </a>
<nav aria-label="TheHiveApi" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.__init__">
    __init__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.create_alert">
    create_alert()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.create_alert_artifact">
    create_alert_artifact()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.create_case">
    create_case()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.create_case_observable">
    create_case_observable()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.create_case_task">
    create_case_task()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.create_case_template">
    create_case_template()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.create_custom_field">
    create_custom_field()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.create_task_log">
    create_task_log()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.delete_alert">
    delete_alert()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.delete_alert_artifact">
    delete_alert_artifact()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.delete_case">
    delete_case()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.delete_case_observable">
    delete_case_observable()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.delete_case_task">
    delete_case_task()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.download_attachment">
    download_attachment()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.download_observable_attachment">
    download_observable_attachment()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.download_task_log_attachment">
    download_task_log_attachment()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.export_to_misp">
    export_to_misp()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.find_alerts">
    find_alerts()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.find_case_templates">
    find_case_templates()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.find_cases">
    find_cases()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.find_first">
    find_first()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.find_observables">
    find_observables()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.find_task_logs">
    find_task_logs()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.find_tasks">
    find_tasks()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.get_alert">
    get_alert()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.get_case">
    get_case()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.get_case_observable">
    get_case_observable()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.get_case_observables">
    get_case_observables()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.get_case_task">
    get_case_task()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.get_case_tasks">
    get_case_tasks()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.get_case_template">
    get_case_template()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.get_current_user">
    get_current_user()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.get_linked_cases">
    get_linked_cases()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.get_task_log">
    get_task_log()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.get_task_logs">
    get_task_logs()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.health">
    health()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.mark_alert_as_read">
    mark_alert_as_read()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.mark_alert_as_unread">
    mark_alert_as_unread()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.merge_alert_into_case">
    merge_alert_into_case()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.promote_alert_to_case">
    promote_alert_to_case()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.run_analyzer">
    run_analyzer()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.update_alert">
    update_alert()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.update_alert_artifact">
    update_alert_artifact()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.update_case">
    update_case()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.update_case_observable">
    update_case_observable()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.update_case_observables">
    update_case_observables()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.update_case_task">
    update_case_task()
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../query/" title="Query">
      Query
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../exceptions/" title="Exceptions">
      Exceptions
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" id="nav-3" type="checkbox"/>
<label class="md-nav__link" for="nav-3">
      Examples
      <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg>
</span>
</label>
<nav aria-label="Examples" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="nav-3">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
        Examples
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../samples/alert-operations/" title="Alert operations">
      Alert operations
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../samples/case-operations/" title="Case operations">
      Case operations
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../samples/task-operations/" title="Task operations">
      Task operations
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../samples/observable-operations/" title="Observable operations">
      Observable operations
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../samples/admin-operations/" title="Admin operations">
      Admin operations
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../changelog/" title="Change Log">
      Change Log
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../code_of_conduct/" title="Contributor Covenant Code of Conduct">
      Contributor Covenant Code of Conduct
    </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api">
    thehive4py.api
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi">
    TheHiveApi
  </a>
<nav aria-label="TheHiveApi" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.__init__">
    __init__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.create_alert">
    create_alert()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.create_alert_artifact">
    create_alert_artifact()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.create_case">
    create_case()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.create_case_observable">
    create_case_observable()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.create_case_task">
    create_case_task()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.create_case_template">
    create_case_template()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.create_custom_field">
    create_custom_field()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.create_task_log">
    create_task_log()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.delete_alert">
    delete_alert()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.delete_alert_artifact">
    delete_alert_artifact()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.delete_case">
    delete_case()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.delete_case_observable">
    delete_case_observable()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.delete_case_task">
    delete_case_task()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.download_attachment">
    download_attachment()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.download_observable_attachment">
    download_observable_attachment()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.download_task_log_attachment">
    download_task_log_attachment()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.export_to_misp">
    export_to_misp()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.find_alerts">
    find_alerts()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.find_case_templates">
    find_case_templates()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.find_cases">
    find_cases()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.find_first">
    find_first()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.find_observables">
    find_observables()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.find_task_logs">
    find_task_logs()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.find_tasks">
    find_tasks()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.get_alert">
    get_alert()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.get_case">
    get_case()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.get_case_observable">
    get_case_observable()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.get_case_observables">
    get_case_observables()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.get_case_task">
    get_case_task()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.get_case_tasks">
    get_case_tasks()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.get_case_template">
    get_case_template()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.get_current_user">
    get_current_user()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.get_linked_cases">
    get_linked_cases()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.get_task_log">
    get_task_log()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.get_task_logs">
    get_task_logs()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.health">
    health()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.mark_alert_as_read">
    mark_alert_as_read()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.mark_alert_as_unread">
    mark_alert_as_unread()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.merge_alert_into_case">
    merge_alert_into_case()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.promote_alert_to_case">
    promote_alert_to_case()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.run_analyzer">
    run_analyzer()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.update_alert">
    update_alert()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.update_alert_artifact">
    update_alert_artifact()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.update_case">
    update_case()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.update_case_observable">
    update_case_observable()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.update_case_observables">
    update_case_observables()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thehive4py.api.TheHiveApi.update_case_task">
    update_case_task()
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/TheHive-Project/TheHive4py/edit/master/docs/reference/api.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"></path></svg>
</a>
<h1 id="api">API<a class="headerlink" href="#api" title="Permanent link">#</a></h1>
<p>This is the reference of all the methods available on <code>thehive4py.api.TheHiveApi</code>.</p>
<div class="doc doc-object doc-module">
<h2 class="hidden-toc" href="#thehive4py.api" id="thehive4py.api" style="visibility: hidden; width: 0; height: 0;">
<a class="headerlink" href="#thehive4py.api" title="Permanent link">#</a></h2>
<div class="doc doc-contents first">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="thehive4py.api.TheHiveApi">
<code>TheHiveApi</code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi" title="Permanent link">#</a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.__init__">
<code class="highlight language-python">
__init__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">principal</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="p">{},</span> <span class="n">cert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">organisation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.__init__" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Python API client for TheHive.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>url</code></td>
<td><code>str</code></td>
<td>
<p>URL of Thehive instance, including the port. Ex: <code>http://myserver:9000</code></p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>principal</code></td>
<td><code>str</code></td>
<td>
<p>The API key, or the username if basic authentication is used.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>password</code></td>
<td><code>str</code></td>
<td>
<p>The password for basic authentication or None. Defaults to None</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>proxies</code></td>
<td><code>dict</code></td>
<td>
<p>The proxy configuration, would have <code>http</code> and <code>https</code> attributes. Defaults to {}
<div class="highlight">
<pre><span></span><code><span class="n">proxies</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"http: "</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">my_proxy</span><span class="p">:</span><span class="mi">8080</span><span class="s2">"</span>
    <span class="s2">"https: "</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">my_proxy</span><span class="p">:</span><span class="mi">8080</span><span class="s2">"</span>
<span class="p">}</span>
</code></pre>
</div>
</p>
</td>
<td><code>{}</code></td>
</tr>
<tr>
<td><code>cert</code></td>
<td><code>bool</code></td>
<td>
<p>Wether or not to enable SSL certificate validation</p>
</td>
<td><code>True</code></td>
</tr>
<tr>
<td><code>organisation</code></td>
<td><code>str</code></td>
<td>
<p>The name of the organisation against which api calls will be run. Defaults to None</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>version</code></td>
<td><code>int</code></td>
<td>
<p>The version of TheHive instance. Defaults to 3</p>
</td>
<td><code>3</code></td>
</tr>
</tbody>
</table>
<details class="note"><summary>Examples</summary><div class="tabbed-set" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio"><label for="__tabbed_1_1">Basic</label><div class="tabbed-content">
<p>Example of simple usage: call TheHive APIs using an API key, without proxy, nor organisation</p>
<div class="highlight">
<pre><span></span><code><span class="n">api</span> <span class="o">=</span> <span class="n">TheHiveApi</span><span class="p">(</span><span class="s1">'http://my_thehive:9000'</span><span class="p">,</span> <span class="s1">'my_api_key'</span><span class="p">)</span>
</code></pre>
</div>
</div>
<input id="__tabbed_1_2" name="__tabbed_1" type="radio"><label for="__tabbed_1_2">Full options</label><div class="tabbed-content">
<p>Example using all the options: call TheHive APIs using an API key, with orgnisation, proxy and sst certificate</p>
<div class="highlight">
<pre><span></span><code><span class="n">proxies</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"http: "</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">my_proxy</span><span class="p">:</span><span class="mi">8080</span><span class="s2">"</span>
    <span class="s2">"https: "</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">my_proxy</span><span class="p">:</span><span class="mi">8080</span><span class="s2">"</span>
<span class="p">}</span>
<span class="n">api</span> <span class="o">=</span> <span class="n">TheHiveApi</span><span class="p">(</span><span class="s1">'http://my_thehive:9000'</span><span class="p">,</span>
    <span class="s1">'my_api_key'</span><span class="p">,</span>
    <span class="kc">None</span><span class="p">,</span>
    <span class="n">proxies</span><span class="p">,</span>
    <span class="kc">True</span><span class="p">,</span>
    <span class="s1">'my-org'</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="n">Version</span><span class="o">.</span><span class="n">THEHIVE_3</span><span class="o">.</span><span class="n">value</span>
<span class="p">)</span>
</code></pre>
</div>
</div>
</input></input></div>
</details>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">principal</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="p">{},</span> <span class="n">cert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">organisation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">version</span><span class="o">=</span><span class="n">Version</span><span class="o">.</span><span class="n">THEHIVE_3</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Python API client for TheHive.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        url (str): URL of Thehive instance, including the port. Ex: `http://myserver:9000`</span>
<span class="sd">        principal (str): The API key, or the username if basic authentication is used.</span>
<span class="sd">        password (str): The password for basic authentication or None. Defaults to None</span>
<span class="sd">        proxies (dict): The proxy configuration, would have `http` and `https` attributes. Defaults to {}</span>
<span class="sd">            ```python</span>
<span class="sd">            proxies: {</span>
<span class="sd">                "http: "http://my_proxy:8080"</span>
<span class="sd">                "https: "http://my_proxy:8080"</span>
<span class="sd">            }</span>
<span class="sd">            ```</span>
<span class="sd">        cert (bool): Wether or not to enable SSL certificate validation</span>
<span class="sd">        organisation (str): The name of the organisation against which api calls will be run. Defaults to None</span>
<span class="sd">        version (int): The version of TheHive instance. Defaults to 3</span>


<span class="sd">    ??? note "Examples"</span>
<span class="sd">        === "Basic"</span>
<span class="sd">            Example of simple usage: call TheHive APIs using an API key, without proxy, nor organisation</span>

<span class="sd">            ```python</span>
<span class="sd">            api = TheHiveApi('http://my_thehive:9000', 'my_api_key')</span>
<span class="sd">            ```</span>

<span class="sd">        === "Full options"</span>
<span class="sd">            Example using all the options: call TheHive APIs using an API key, with orgnisation, proxy and sst certificate</span>

<span class="sd">            ```python</span>
<span class="sd">            proxies = {</span>
<span class="sd">                "http: "http://my_proxy:8080"</span>
<span class="sd">                "https: "http://my_proxy:8080"</span>
<span class="sd">            }</span>
<span class="sd">            api = TheHiveApi('http://my_thehive:9000',</span>
<span class="sd">                'my_api_key',</span>
<span class="sd">                None,</span>
<span class="sd">                proxies,</span>
<span class="sd">                True,</span>
<span class="sd">                'my-org',</span>
<span class="sd">                version=Version.THEHIVE_3.value</span>
<span class="sd">            )</span>
<span class="sd">            ```</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="n">url</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">principal</span> <span class="o">=</span> <span class="n">principal</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="n">password</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">proxies</span> <span class="o">=</span> <span class="n">proxies</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">organisation</span> <span class="o">=</span> <span class="n">organisation</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auth</span> <span class="o">=</span> <span class="n">BasicAuth</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">principal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">password</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">organisation</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auth</span> <span class="o">=</span> <span class="n">BearerAuth</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">principal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">organisation</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">cert</span> <span class="o">=</span> <span class="n">cert</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">version</span>

    <span class="c1"># Create a CaseHelper instance</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">case</span> <span class="o">=</span> <span class="n">CaseHelper</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.create_alert">
<code class="highlight language-python">
create_alert<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.create_alert" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Create an alert. Supports adding observables and custom fields</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>alert</code></td>
<td><code>Alert</code></td>
<td>
<p>Instance of <a href="https://thehive-project.github.io/thehive4py/reference/models/#thehive4py.models.Alert">Alert</a></p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON array representing a list of case task logs</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AlertException</code></td>
<td>
<p>An error occured during alert creation</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>882
883
884
885
886
887
888
889
890
891
892
893
894
895
896
897
898
899
900
901
902
903
904
905
906
907
908
909
910
911</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">create_alert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert</span><span class="p">):</span>

    <span class="sd">"""</span>
<span class="sd">    Create an alert. Supports adding observables and custom fields</span>

<span class="sd">    Arguments:</span>
<span class="sd">        alert (Alert): Instance of [Alert][thehive4py.models.Alert]</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON array representing a list of case task logs</span>

<span class="sd">    Raises:</span>
<span class="sd">        AlertException: An error occured during alert creation</span>
<span class="sd">    """</span>

    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/alert"</span>

    <span class="n">to_exclude</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'id'</span><span class="p">]</span>

    <span class="c1"># Exclude PAP field for TheHive 3</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isVersion</span><span class="p">(</span><span class="n">Version</span><span class="o">.</span><span class="n">THEHIVE_3</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
        <span class="n">to_exclude</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'pap'</span><span class="p">)</span>
        <span class="n">to_exclude</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'externalLink'</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">jsonify</span><span class="p">(</span><span class="n">excludes</span><span class="o">=</span><span class="n">to_exclude</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">},</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">AlertException</span><span class="p">(</span><span class="s2">"Alert create error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.create_alert_artifact">
<code class="highlight language-python">
create_alert_artifact<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert_id</span><span class="p">,</span> <span class="n">alert_artifact</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.create_alert_artifact" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Create an alert artifact</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>alert_id</code></td>
<td><code>str</code></td>
<td>
<p>Alert identifier</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>alert_artifact</code></td>
<td><code>AlertArtifact</code></td>
<td>
<p>Instance of <a href="https://thehive-project.github.io/thehive4py/reference/models/#thehive4py.models.AlertArtifact">AlertArtifact</a></p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON description of an alert artifact</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AlertArtifactException</code></td>
<td>
<p>An error occured during alert artifact creation</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function is available in TheHive 4 ONLY</p>
</div>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>1306
1307
1308
1309
1310
1311
1312
1313
1314
1315
1316
1317
1318
1319
1320
1321
1322
1323
1324
1325
1326
1327
1328
1329
1330
1331
1332
1333
1334
1335
1336
1337
1338
1339
1340
1341
1342
1343
1344
1345</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">create_alert_artifact</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert_id</span><span class="p">,</span> <span class="n">alert_artifact</span><span class="p">):</span>

    <span class="sd">"""</span>
<span class="sd">    Create an alert artifact</span>

<span class="sd">    Arguments:</span>
<span class="sd">        alert_id (str): Alert identifier</span>
<span class="sd">        alert_artifact (AlertArtifact): Instance of [AlertArtifact][thehive4py.models.AlertArtifact]</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON description of an alert artifact</span>

<span class="sd">    Raises:</span>
<span class="sd">        AlertArtifactException: An error occured during alert artifact creation</span>

<span class="sd">    !!! Warning</span>
<span class="sd">        This function is available in TheHive 4 ONLY</span>
<span class="sd">    """</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isVersion</span><span class="p">(</span><span class="n">Version</span><span class="o">.</span><span class="n">THEHIVE_3</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">AlertArtifactException</span><span class="p">(</span><span class="s2">"This function is available in TheHive 4 ONLY"</span><span class="p">)</span>

    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/alert/</span><span class="si">{}</span><span class="s2">/artifact"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alert_id</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">alert_artifact</span><span class="o">.</span><span class="n">dataType</span> <span class="o">==</span> <span class="s1">'file'</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"dataType"</span><span class="p">,</span> <span class="s2">"message"</span><span class="p">,</span> <span class="s2">"tlp"</span><span class="p">,</span> <span class="s2">"tags"</span><span class="p">,</span> <span class="s2">"ioc"</span><span class="p">,</span> <span class="s2">"sighted"</span><span class="p">,</span> <span class="s2">"ignoreSimilarity"</span><span class="p">]</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">alert_artifact</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">}</span>

            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"_json"</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)}</span>
            <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">alert_artifact</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AlertArtifactException</span><span class="p">(</span><span class="s2">"Alert artifact create error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">alert_artifact</span><span class="o">.</span><span class="n">jsonify</span><span class="p">(</span><span class="n">excludes</span><span class="o">=</span><span class="p">[</span><span class="s1">'id'</span><span class="p">])</span>

            <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">},</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AlertArtifactException</span><span class="p">(</span><span class="s2">"Alert artifact create error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.create_case">
<code class="highlight language-python">
create_case<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.create_case" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Create a case</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>case</code></td>
<td><code>Case</code></td>
<td>
<p>Instance of <a href="https://thehive-project.github.io/thehive4py/reference/models/#thehive4py.models.Case">Case</a></p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON description of a case</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseException</code></td>
<td>
<p>An error occured during case creation</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">create_case</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case</span><span class="p">):</span>

    <span class="sd">"""</span>
<span class="sd">    Create a case</span>

<span class="sd">    Arguments:</span>
<span class="sd">        case (Case): Instance of [Case][thehive4py.models.Case]</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON description of a case</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseException: An error occured during case creation</span>
<span class="sd">    """</span>

    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/case"</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">case</span><span class="o">.</span><span class="n">jsonify</span><span class="p">(</span><span class="n">excludes</span><span class="o">=</span><span class="p">[</span><span class="s1">'id'</span><span class="p">])</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">},</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CaseException</span><span class="p">(</span><span class="s2">"Case create error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.create_case_observable">
<code class="highlight language-python">
create_case_observable<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case_id</span><span class="p">,</span> <span class="n">case_observable</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.create_case_observable" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Create a case observable</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>case_id</code></td>
<td><code>str</code></td>
<td>
<p>Case identifier</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>case_observable</code></td>
<td><code>CaseObservable</code></td>
<td>
<p>Instance of <a href="https://thehive-project.github.io/thehive4py/reference/models/#thehive4py.models.CaseObservable">CaseObservable</a></p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON description of a case observable</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseObservableException</code></td>
<td>
<p>An error occured during case observable creation</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">create_case_observable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case_id</span><span class="p">,</span> <span class="n">case_observable</span><span class="p">):</span>

    <span class="sd">"""</span>
<span class="sd">    Create a case observable</span>

<span class="sd">    Arguments:</span>
<span class="sd">        case_id (str): Case identifier</span>
<span class="sd">        case_observable (CaseObservable): Instance of [CaseObservable][thehive4py.models.CaseObservable]</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON description of a case observable</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseObservableException: An error occured during case observable creation</span>
<span class="sd">    """</span>

    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/case/</span><span class="si">{}</span><span class="s2">/artifact"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">case_id</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">case_observable</span><span class="o">.</span><span class="n">dataType</span> <span class="o">==</span> <span class="s1">'file'</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>

            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">"dataType"</span><span class="p">:</span> <span class="n">case_observable</span><span class="o">.</span><span class="n">dataType</span><span class="p">,</span>
                <span class="s2">"message"</span><span class="p">:</span> <span class="n">case_observable</span><span class="o">.</span><span class="n">message</span><span class="p">,</span>
                <span class="s2">"tlp"</span><span class="p">:</span> <span class="n">case_observable</span><span class="o">.</span><span class="n">tlp</span><span class="p">,</span>
                <span class="s2">"tags"</span><span class="p">:</span> <span class="n">case_observable</span><span class="o">.</span><span class="n">tags</span><span class="p">,</span>
                <span class="s2">"ioc"</span><span class="p">:</span> <span class="n">case_observable</span><span class="o">.</span><span class="n">ioc</span><span class="p">,</span>
                <span class="s2">"sighted"</span><span class="p">:</span> <span class="n">case_observable</span><span class="o">.</span><span class="n">sighted</span><span class="p">,</span>
                <span class="s2">"ignoreSimilarity"</span><span class="p">:</span> <span class="n">case_observable</span><span class="o">.</span><span class="n">ignoreSimilarity</span>
            <span class="p">}</span>

            <span class="c1"># Exclude ignoreSimilarity field for TheHive 3</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isVersion</span><span class="p">(</span><span class="n">Version</span><span class="o">.</span><span class="n">THEHIVE_3</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
                <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">'ignoreSimilarity'</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"_json"</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)}</span>
            <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">case_observable</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CaseObservableException</span><span class="p">(</span><span class="s2">"Case observable create error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">to_exclude</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'id'</span><span class="p">]</span>

            <span class="c1"># Exclude ignoreSimilarity field for TheHive 3</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isVersion</span><span class="p">(</span><span class="n">Version</span><span class="o">.</span><span class="n">THEHIVE_3</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
                <span class="n">to_exclude</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'ignoreSimilarity'</span><span class="p">)</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">case_observable</span><span class="o">.</span><span class="n">jsonify</span><span class="p">(</span><span class="n">excludes</span><span class="o">=</span><span class="n">to_exclude</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">},</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CaseObservableException</span><span class="p">(</span><span class="s2">"Case observable create error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.create_case_task">
<code class="highlight language-python">
create_case_task<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case_id</span><span class="p">,</span> <span class="n">case_task</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.create_case_task" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Create a case task</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>case_id</code></td>
<td><code></code></td>
<td>
<p>Case identifier</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>case_task</code></td>
<td><code></code></td>
<td>
<p>Instance of <a href="https://thehive-project.github.io/thehive4py/reference/models/#thehive4py.models.CaseTask">CaseTask</a></p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON description of a case task</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseTaskException</code></td>
<td>
<p>An error occured during case task creation</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">create_case_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case_id</span><span class="p">,</span> <span class="n">case_task</span><span class="p">):</span>

    <span class="sd">"""</span>
<span class="sd">    Create a case task</span>

<span class="sd">    Arguments:</span>
<span class="sd">        case_id: Case identifier</span>
<span class="sd">        case_task: Instance of [CaseTask][thehive4py.models.CaseTask]</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON description of a case task</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseTaskException: An error occured during case task creation</span>

<span class="sd">    """</span>

    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/case/</span><span class="si">{}</span><span class="s2">/task"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">case_id</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">case_task</span><span class="o">.</span><span class="n">jsonify</span><span class="p">(</span><span class="n">excludes</span><span class="o">=</span><span class="p">[</span><span class="s1">'id'</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">},</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CaseTaskException</span><span class="p">(</span><span class="s2">"Case task create error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.create_case_template">
<code class="highlight language-python">
create_case_template<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case_template</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.create_case_template" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Create a case template</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>case_template</code></td>
<td><code>CaseTemplate</code></td>
<td>
<p>Instance of <a href="https://thehive-project.github.io/thehive4py/reference/models/#thehive4py.models.CaseTemplate">CaseTemplate</a></p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON representation of the case template</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseTemplateException</code></td>
<td>
<p>An error occured during case template creation</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>719
720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">create_case_template</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case_template</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Create a case template</span>

<span class="sd">    Arguments:</span>
<span class="sd">        case_template (CaseTemplate): Instance of [CaseTemplate][thehive4py.models.CaseTemplate]</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON representation of the case template</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseTemplateException: An error occured during case template creation</span>
<span class="sd">    """</span>

    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/case/template"</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">case_template</span><span class="o">.</span><span class="n">jsonify</span><span class="p">(</span><span class="n">excludes</span><span class="o">=</span><span class="p">[</span><span class="s1">'id'</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">},</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CaseTemplateException</span><span class="p">(</span><span class="s2">"Case template create error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.create_custom_field">
<code class="highlight language-python">
create_custom_field<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">custom_field</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.create_custom_field" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Create a custom field</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>custom_field</code></td>
<td><code>CustomField</code></td>
<td>
<p>Instance of <a href="https://thehive-project.github.io/thehive4py/reference/models/#thehive4py.models.CustomField">CustomField</a></p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON representation of the case template</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CustomFieldException</code></td>
<td>
<p>Custom field already exists</p>
</td>
</tr>
<tr>
<td><code>CustomFieldException</code></td>
<td>
<p>An error occured during custom field creation</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function is available only for TheHive 3</p>
</div>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>750
751
752
753
754
755
756
757
758
759
760
761
762
763
764
765
766
767
768
769
770
771
772
773
774
775
776
777
778
779
780
781
782
783
784
785</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">create_custom_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">custom_field</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Create a custom field</span>

<span class="sd">    Arguments:</span>
<span class="sd">        custom_field (CustomField): Instance of [CustomField][thehive4py.models.CustomField]</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON representation of the case template</span>

<span class="sd">    Raises:</span>
<span class="sd">        CustomFieldException: Custom field already exists</span>
<span class="sd">        CustomFieldException: An error occured during custom field creation</span>

<span class="sd">    !!! Warning</span>
<span class="sd">        This function is available only for TheHive 3</span>
<span class="sd">    """</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_if_custom_field_exists</span><span class="p">(</span><span class="n">custom_field</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">CustomFieldException</span><span class="p">(</span><span class="s1">'Field with reference "</span><span class="si">{}</span><span class="s1">" already exists'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">custom_field</span><span class="o">.</span><span class="n">reference</span><span class="p">))</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">"value"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">"name"</span><span class="p">:</span> <span class="n">custom_field</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">"reference"</span><span class="p">:</span> <span class="n">custom_field</span><span class="o">.</span><span class="n">reference</span><span class="p">,</span>
            <span class="s2">"description"</span><span class="p">:</span> <span class="n">custom_field</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
            <span class="s2">"type"</span><span class="p">:</span> <span class="n">custom_field</span><span class="o">.</span><span class="n">type</span><span class="p">,</span>
            <span class="s2">"options"</span><span class="p">:</span> <span class="n">custom_field</span><span class="o">.</span><span class="n">options</span><span class="p">,</span>
            <span class="s2">"mandatory"</span><span class="p">:</span> <span class="n">custom_field</span><span class="o">.</span><span class="n">mandatory</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/list/custom_fields"</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CustomFieldException</span><span class="p">(</span><span class="s2">"Custom field create error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.create_task_log">
<code class="highlight language-python">
create_task_log<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_id</span><span class="p">,</span> <span class="n">case_task_log</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.create_task_log" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Create a task log either with an attachement or just with a log message.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>task_id</code></td>
<td><code>str</code></td>
<td>
<p>Task identifier</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>case_task_log</code></td>
<td><code>CaseTaskLocg</code></td>
<td>
<p>Instance of <a href="https://thehive-project.github.io/thehive4py/reference/models/#thehive4py.models.CaseTaskLog">CaseTaskLog</a></p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON description of a case</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseException</code></td>
<td>
<p>An error occured during case creation</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">create_task_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_id</span><span class="p">,</span> <span class="n">case_task_log</span><span class="p">):</span>

    <span class="sd">"""</span>
<span class="sd">    Create a task log either with an attachement or just with a log message.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        task_id (str): Task identifier</span>
<span class="sd">        case_task_log (CaseTaskLocg): Instance of [CaseTaskLog][thehive4py.models.CaseTaskLog]</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON description of a case</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseException: An error occured during case creation</span>
<span class="sd">    """</span>

    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/case/task/</span><span class="si">{}</span><span class="s2">/log"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">task_id</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'_json'</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">"message"</span><span class="p">:</span> <span class="n">case_task_log</span><span class="o">.</span><span class="n">message</span><span class="p">})}</span>

    <span class="k">if</span> <span class="n">case_task_log</span><span class="o">.</span><span class="n">file</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">case_task_log</span><span class="o">.</span><span class="n">attachment</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CaseTaskException</span><span class="p">(</span><span class="s2">"Case task log create error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">},</span> <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s1">'message'</span><span class="p">:</span><span class="n">case_task_log</span><span class="o">.</span><span class="n">message</span><span class="p">}),</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CaseTaskException</span><span class="p">(</span><span class="s2">"Case task log create error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.delete_alert">
<code class="highlight language-python">
delete_alert<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert_id</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.delete_alert" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Deletes a TheHive alert.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>alert_id</code></td>
<td><code>str</code></td>
<td>
<p>Id of the alert to delete</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including true or false based on the action's success</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AlertException</code></td>
<td>
<p>An error occured during alert deletion</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>TheHive 3: Deleting alert requires <code>admin</code> role
TheHive 4: Deleting alert requires a role including <code>manageAlert</code> permissing</p>
</div>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>1055
1056
1057
1058
1059
1060
1061
1062
1063
1064
1065
1066
1067
1068
1069
1070
1071
1072
1073
1074
1075
1076
1077
1078
1079
1080</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">delete_alert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert_id</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Deletes a TheHive alert.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        alert_id (str): Id of the alert to delete</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including true or false based on the action's success</span>

<span class="sd">    Raises:</span>
<span class="sd">        AlertException: An error occured during alert deletion</span>

<span class="sd">    !!! Warning</span>
<span class="sd">        TheHive 3: Deleting alert requires `admin` role</span>
<span class="sd">        TheHive 4: Deleting alert requires a role including `manageAlert` permissing</span>
<span class="sd">    """</span>

    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/alert/</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alert_id</span><span class="p">)</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">"force"</span><span class="p">:</span> <span class="mi">1</span>
    <span class="p">}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">AlertException</span><span class="p">(</span><span class="s2">"Alert deletion error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.delete_alert_artifact">
<code class="highlight language-python">
delete_alert_artifact<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">artifact_id</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.delete_alert_artifact" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Deletes a TheHive alert artifact.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>artifact_id</code></td>
<td><code>str</code></td>
<td>
<p>Id of the artifact to delete</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including true or false based on the action's success</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AlertArtifactException</code></td>
<td>
<p>An error occured during alert artifact deletion</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function is available in TheHive 4 ONLY</p>
</div>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>1347
1348
1349
1350
1351
1352
1353
1354
1355
1356
1357
1358
1359
1360
1361
1362
1363
1364
1365
1366
1367
1368
1369
1370
1371
1372</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">delete_alert_artifact</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">artifact_id</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Deletes a TheHive alert artifact.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        artifact_id (str): Id of the artifact to delete</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including true or false based on the action's success</span>

<span class="sd">    Raises:</span>
<span class="sd">        AlertArtifactException: An error occured during alert artifact deletion</span>

<span class="sd">    !!! Warning</span>
<span class="sd">        This function is available in TheHive 4 ONLY</span>
<span class="sd">    """</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isVersion</span><span class="p">(</span><span class="n">Version</span><span class="o">.</span><span class="n">THEHIVE_3</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">AlertArtifactException</span><span class="p">(</span><span class="s2">"This function is available in TheHive 4 ONLY"</span><span class="p">)</span>

    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/alert/artifact/</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">artifact_id</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">AlertArtifactException</span><span class="p">(</span><span class="s2">"Alert artifact deletion error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.delete_case">
<code class="highlight language-python">
delete_case<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case_id</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.delete_case" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Deletes a TheHive case. Unless force is set to True the case is 'soft deleted' (status set to deleted).</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>case_id</code></td>
<td><code>str</code></td>
<td>
<p>Id of the case to delete</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>force</code></td>
<td><code>bool</code></td>
<td>
<p>True to physically delete the case, False to mark the case as deleted</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including true or false based on the action's success</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseException</code></td>
<td>
<p>An error occured during case deletion</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">delete_case</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case_id</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Deletes a TheHive case. Unless force is set to True the case is 'soft deleted' (status set to deleted).</span>

<span class="sd">    Arguments:</span>
<span class="sd">        case_id (str): Id of the case to delete</span>
<span class="sd">        force (bool): True to physically delete the case, False to mark the case as deleted</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including true or false based on the action's success</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseException: An error occured during case deletion</span>
<span class="sd">    """</span>
    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/case/</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">case_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">force</span><span class="p">:</span>
        <span class="n">req</span> <span class="o">+=</span> <span class="s1">'/force'</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CaseException</span><span class="p">(</span><span class="s2">"Case deletion error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.delete_case_observable">
<code class="highlight language-python">
delete_case_observable<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observable_id</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.delete_case_observable" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Deletes a TheHive case observable.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>observable_id</code></td>
<td><code>str</code></td>
<td>
<p>Id of the observable to delete</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including true or false based on the action's success</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseObservableException</code></td>
<td>
<p>An error occured during case observable deletion</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">delete_case_observable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observable_id</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Deletes a TheHive case observable.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        observable_id (str): Id of the observable to delete</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including true or false based on the action's success</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseObservableException: An error occured during case observable deletion</span>
<span class="sd">    """</span>
    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/case/artifact/</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">observable_id</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CaseObservableException</span><span class="p">(</span><span class="s2">"Case observable deletion error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.delete_case_task">
<code class="highlight language-python">
delete_case_task<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_id</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.delete_case_task" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Deletes a TheHive case task.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>task_id</code></td>
<td><code>str</code></td>
<td>
<p>Id of the task to delete</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including the updated task</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseException</code></td>
<td>
<p>An error occured during case deletion</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">delete_case_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_id</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Deletes a TheHive case task.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        task_id (str): Id of the task to delete</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including the updated task</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseException: An error occured during case deletion</span>
<span class="sd">    """</span>
    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/case/task/</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">task_id</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">},</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="s1">'status'</span><span class="p">:</span> <span class="s1">'Cancel'</span><span class="p">},</span>
                               <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CaseTaskException</span><span class="p">(</span><span class="s2">"Case task deletion error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.download_attachment">
<code class="highlight language-python">
download_attachment<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attachment_id</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">'attachment'</span><span class="p">,</span> <span class="n">archive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.download_attachment" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Get the content of an attachement object by ID</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>attachment_id</code></td>
<td><code></code></td>
<td>
<p>identifier of the attachment object</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>filename</code></td>
<td><code>str</code></td>
<td>
<p>name of the downloaded file</p>
</td>
<td><code>'attachment'</code></td>
</tr>
<tr>
<td><code>archive</code></td>
<td><code>bool</code></td>
<td>
<p>set to <code>True</code> to zip and password protect the downloaded file</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a the attachment content as bytes</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>TheHiveException</code></td>
<td>
<p>An error occured during the attachment download</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>1216
1217
1218
1219
1220
1221
1222
1223
1224
1225
1226
1227
1228
1229
1230
1231
1232
1233
1234
1235
1236
1237
1238
1239</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">download_attachment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attachment_id</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">"attachment"</span><span class="p">,</span> <span class="n">archive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Get the content of an attachement object by ID</span>

<span class="sd">    Arguments:</span>
<span class="sd">        attachment_id: identifier of the attachment object</span>
<span class="sd">        filename (str): name of the downloaded file</span>
<span class="sd">        archive (bool): set to `True` to zip and password protect the downloaded file</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a the attachment content as bytes</span>

<span class="sd">    Raises:</span>
<span class="sd">        TheHiveException: An error occured during the attachment download</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">archive</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/datastorezip/</span><span class="si">{}</span><span class="s2">?name</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">attachment_id</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/datastore/</span><span class="si">{}</span><span class="s2">?name=</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">attachment_id</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">TheHiveException</span><span class="p">(</span><span class="s2">"Error on retrieving attachment </span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">attachment_id</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.download_observable_attachment">
<code class="highlight language-python">
download_observable_attachment<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observable_id</span><span class="p">,</span> <span class="n">archive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.download_observable_attachment" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Get the content of the attachement object of a file observable</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>observable_id</code></td>
<td><code></code></td>
<td>
<p>identifier of the case observable object</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>archive</code></td>
<td><code>bool</code></td>
<td>
<p>set to <code>False</code> to disable zip and password protection of the downloaded file</p>
</td>
<td><code>True</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a the attachment content as bytes</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseObservableException</code></td>
<td>
<p>If the observable is not a file</p>
</td>
</tr>
<tr>
<td><code>TheHiveException</code></td>
<td>
<p>An error occured during the attachment download</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>1275
1276
1277
1278
1279
1280
1281
1282
1283
1284
1285
1286
1287
1288
1289
1290
1291
1292
1293
1294
1295
1296
1297
1298
1299
1300
1301
1302
1303
1304</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">download_observable_attachment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observable_id</span><span class="p">,</span> <span class="n">archive</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Get the content of the attachement object of a file observable</span>

<span class="sd">    Arguments:</span>
<span class="sd">        observable_id: identifier of the case observable object</span>
<span class="sd">        archive (bool): set to `False` to disable zip and password protection of the downloaded file</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a the attachment content as bytes</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseObservableException: If the observable is not a file</span>
<span class="sd">        TheHiveException: An error occured during the attachment download</span>
<span class="sd">    """</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Get the observable by id</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_case_observable</span><span class="p">(</span><span class="n">observable_id</span><span class="p">)</span>

        <span class="c1"># Check if it has an attachment</span>
        <span class="n">observable</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

        <span class="k">if</span> <span class="s1">'attachment'</span> <span class="ow">in</span> <span class="n">observable</span><span class="p">:</span>
            <span class="n">attachment</span> <span class="o">=</span> <span class="n">observable</span><span class="p">[</span><span class="s1">'attachment'</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">download_attachment</span><span class="p">(</span><span class="n">attachment</span><span class="p">[</span><span class="s1">'id'</span><span class="p">],</span> <span class="n">filename</span><span class="o">=</span><span class="n">attachment</span><span class="p">[</span><span class="s1">'name'</span><span class="p">],</span> <span class="n">archive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CaseObservableException</span><span class="p">(</span><span class="s2">"Observable </span><span class="si">{}</span><span class="s2"> doesn't have an attachment"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">observable_id</span><span class="p">))</span>

    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CaseObservableException</span><span class="p">(</span><span class="s2">"Error on retrieving attachment of case observable </span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">observable_id</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.download_task_log_attachment">
<code class="highlight language-python">
download_task_log_attachment<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_log_id</span><span class="p">,</span> <span class="n">archive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.download_task_log_attachment" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Get the content of the attachement object of a task log</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>task_log_id</code></td>
<td><code></code></td>
<td>
<p>identifier of the task log object</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>archive</code></td>
<td><code>bool</code></td>
<td>
<p>set to <code>True</code> to zip and password protect the downloaded file</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a the attachment content as bytes</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseTaskLogException</code></td>
<td>
<p>If the task log doesn't have an attachment</p>
</td>
</tr>
<tr>
<td><code>TheHiveException</code></td>
<td>
<p>An error occured during the attachment download</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>1241
1242
1243
1244
1245
1246
1247
1248
1249
1250
1251
1252
1253
1254
1255
1256
1257
1258
1259
1260
1261
1262
1263
1264
1265
1266
1267
1268
1269
1270
1271
1272
1273</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">download_task_log_attachment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_log_id</span><span class="p">,</span> <span class="n">archive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Get the content of the attachement object of a task log</span>

<span class="sd">    Arguments:</span>
<span class="sd">        task_log_id: identifier of the task log object</span>
<span class="sd">        archive (bool): set to `True` to zip and password protect the downloaded file</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a the attachment content as bytes</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseTaskLogException: If the task log doesn't have an attachment</span>
<span class="sd">        TheHiveException: An error occured during the attachment download</span>
<span class="sd">    """</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Get the task log by id</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_task_log</span><span class="p">(</span><span class="n">task_log_id</span><span class="p">)</span>

        <span class="c1"># Check if it has an attachment</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isVersion</span><span class="p">(</span><span class="n">Version</span><span class="o">.</span><span class="n">THEHIVE_3</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
            <span class="n">log</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="s1">'attachment'</span> <span class="ow">in</span> <span class="n">log</span><span class="p">:</span>
            <span class="n">attachment</span> <span class="o">=</span> <span class="n">log</span><span class="p">[</span><span class="s1">'attachment'</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">download_attachment</span><span class="p">(</span><span class="n">attachment</span><span class="p">[</span><span class="s1">'id'</span><span class="p">],</span> <span class="n">filename</span><span class="o">=</span><span class="n">attachment</span><span class="p">[</span><span class="s1">'name'</span><span class="p">],</span> <span class="n">archive</span><span class="o">=</span><span class="n">archive</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CaseTaskLogException</span><span class="p">(</span><span class="s2">"Task log </span><span class="si">{}</span><span class="s2"> doesn't have an attachment"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">task_log_id</span><span class="p">))</span>

    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CaseTaskLogException</span><span class="p">(</span><span class="s2">"Error on retrieving attachment of task log </span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">task_log_id</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.export_to_misp">
<code class="highlight language-python">
export_to_misp<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">misp_id</span><span class="p">,</span> <span class="n">case_id</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.export_to_misp" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Export selected IOCs of a case as an event to a MISP instance 
This function triggers the same action triggered when the "Share" button on the TheHive GUI is clicked</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>misp_id</code></td>
<td><code></code></td>
<td>
<p>identifier of the MISP server</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>case_id</code></td>
<td><code>str</code></td>
<td>
<p>Id of the case</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON representation of the exported event</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>TheHiveException</code></td>
<td>
<p>An error occured during the export operation</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>1193
1194
1195
1196
1197
1198
1199
1200
1201
1202
1203
1204
1205
1206
1207
1208
1209
1210
1211
1212
1213
1214</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">export_to_misp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">misp_id</span><span class="p">,</span> <span class="n">case_id</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Export selected IOCs of a case as an event to a MISP instance </span>
<span class="sd">    This function triggers the same action triggered when the "Share" button on the TheHive GUI is clicked</span>

<span class="sd">    Arguments:</span>
<span class="sd">        misp_id: identifier of the MISP server</span>
<span class="sd">        case_id (str): Id of the case</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON representation of the exported event</span>

<span class="sd">    Raises:</span>
<span class="sd">        TheHiveException: An error occured during the export operation</span>
<span class="sd">    """</span>

    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/connector/misp/export/</span><span class="si">{0}</span><span class="s2">/</span><span class="si">{1}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">case_id</span><span class="p">,</span> <span class="n">misp_id</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">},</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span>
                             <span class="n">json</span><span class="o">=</span><span class="p">{},</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">TheHiveException</span><span class="p">(</span><span class="s2">"MISP export error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.find_alerts">
<code class="highlight language-python">
find_alerts<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.find_alerts" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Find alerts using sort, pagination and a query</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>query</code></td>
<td><code>dict</code></td>
<td>
<p>A query object, defined in JSON format or using utiliy methods from thehive4py.query module</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>sort</code></td>
<td><code>Array</code></td>
<td>
<p>List of fields to sort the result with. Prefix the field name with <code>-</code> for descending order
and <code>+</code> for ascending order</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>range</code></td>
<td><code>str</code></td>
<td>
<p>A range describing the number of rows to be returned</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON array of alerts.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AlertException</code></td>
<td>
<p>An error occured during alert search</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>1036
1037
1038
1039
1040
1041
1042
1043
1044
1045
1046
1047
1048
1049
1050
1051
1052
1053</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">find_alerts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Find alerts using sort, pagination and a query</span>

<span class="sd">    Arguments:</span>
<span class="sd">        query (dict): A query object, defined in JSON format or using utiliy methods from thehive4py.query module</span>
<span class="sd">        sort (Array): List of fields to sort the result with. Prefix the field name with `-` for descending order</span>
<span class="sd">            and `+` for ascending order</span>
<span class="sd">        range (str): A range describing the number of rows to be returned</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON array of alerts.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AlertException: An error occured during alert search</span>
<span class="sd">    """</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__find_rows</span><span class="p">(</span><span class="s2">"/api/alert/_search"</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.find_case_templates">
<code class="highlight language-python">
find_case_templates<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.find_case_templates" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Find case templates using a query, sort and pagination</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>query</code></td>
<td><code>dict</code></td>
<td>
<p>A query object, defined in JSON format or using utiliy methods from thehive4py.query module</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>sort</code></td>
<td><code>Array</code></td>
<td>
<p>List of fields to sort the result with. Prefix the field name with <code>-</code> for descending order
and <code>+</code> for ascending order</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>range</code></td>
<td><code>str</code></td>
<td>
<p>A range describing the number of rows to be returned</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON array of case templates</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>TheHiveException</code></td>
<td>
<p>An error occured during case template search</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679
680</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">find_case_templates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Find case templates using a query, sort and pagination</span>

<span class="sd">    Arguments:</span>
<span class="sd">        query (dict): A query object, defined in JSON format or using utiliy methods from thehive4py.query module</span>
<span class="sd">        sort (Array): List of fields to sort the result with. Prefix the field name with `-` for descending order</span>
<span class="sd">            and `+` for ascending order</span>
<span class="sd">        range (str): A range describing the number of rows to be returned</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON array of case templates</span>

<span class="sd">    Raises:</span>
<span class="sd">        TheHiveException: An error occured during case template search</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__find_rows</span><span class="p">(</span><span class="s2">"/api/case/template/_search"</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.find_cases">
<code class="highlight language-python">
find_cases<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.find_cases" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Find cases using sort, pagination and a query</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>query</code></td>
<td><code>dict</code></td>
<td>
<p>A query object, defined in JSON format or using utiliy methods from thehive4py.query module</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>sort</code></td>
<td><code>Array</code></td>
<td>
<p>List of fields to sort the result with. Prefix the field name with <code>-</code> for descending order
and <code>+</code> for ascending order</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>range</code></td>
<td><code>str</code></td>
<td>
<p>A range describing the number of rows to be returned</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON array of cases.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseException</code></td>
<td>
<p>An error occured during case search</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">find_cases</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Find cases using sort, pagination and a query</span>

<span class="sd">    Arguments:</span>
<span class="sd">        query (dict): A query object, defined in JSON format or using utiliy methods from thehive4py.query module</span>
<span class="sd">        sort (Array): List of fields to sort the result with. Prefix the field name with `-` for descending order</span>
<span class="sd">            and `+` for ascending order</span>
<span class="sd">        range (str): A range describing the number of rows to be returned</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON array of cases.</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseException: An error occured during case search</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__find_rows</span><span class="p">(</span><span class="s2">"/api/case/_search"</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.find_first">
<code class="highlight language-python">
find_first<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.find_first" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Find cases and return just the first record</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>query</code></td>
<td><code>dict</code></td>
<td>
<p>A query object, defined in JSON format or using utiliy methods from thehive4py.query module</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>sort</code></td>
<td><code>Array</code></td>
<td>
<p>List of fields to sort the result with. Prefix the field name with <code>-</code> for descending order
and <code>+</code> for ascending order</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (dict)</code></td>
<td>
<p>A dict object describing the first case resulting from the query and sort options.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseException</code></td>
<td>
<p>An error occured during case search</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">find_first</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Find cases and return just the first record</span>

<span class="sd">    Arguments:</span>
<span class="sd">        query (dict): A query object, defined in JSON format or using utiliy methods from thehive4py.query module</span>
<span class="sd">        sort (Array): List of fields to sort the result with. Prefix the field name with `-` for descending order</span>
<span class="sd">            and `+` for ascending order</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (dict): A dict object describing the first case resulting from the query and sort options.</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseException: An error occured during case search</span>
<span class="sd">    """</span>
    <span class="n">attributes</span><span class="p">[</span><span class="s1">'range'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'0-1'</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_cases</span><span class="p">(</span><span class="o">**</span><span class="n">attributes</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CaseObservableException</span><span class="p">(</span><span class="s2">"Case search error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.find_observables">
<code class="highlight language-python">
find_observables<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.find_observables" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Find observables using sort, pagination and a query</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>query</code></td>
<td><code>dict</code></td>
<td>
<p>A query object, defined in JSON format or using utiliy methods from thehive4py.query module</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>sort</code></td>
<td><code>Array</code></td>
<td>
<p>List of fields to sort the result with. Prefix the field name with <code>-</code> for descending order
and <code>+</code> for ascending order</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>range</code></td>
<td><code>str</code></td>
<td>
<p>A range describing the number of rows to be returned</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON array of observables.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ObservableException</code></td>
<td>
<p>An error occured during observable search</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">find_observables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Find observables using sort, pagination and a query</span>

<span class="sd">    Arguments:</span>
<span class="sd">        query (dict): A query object, defined in JSON format or using utiliy methods from thehive4py.query module</span>
<span class="sd">        sort (Array): List of fields to sort the result with. Prefix the field name with `-` for descending order</span>
<span class="sd">            and `+` for ascending order</span>
<span class="sd">        range (str): A range describing the number of rows to be returned</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON array of observables.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ObservableException: An error occured during observable search</span>
<span class="sd">    """</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__find_rows</span><span class="p">(</span><span class="s2">"/api/case/artifact/_search"</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.find_task_logs">
<code class="highlight language-python">
find_task_logs<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.find_task_logs" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Find task logs using sort, pagination and a query</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>query</code></td>
<td><code>dict</code></td>
<td>
<p>A query object, defined in JSON format or using utiliy methods from thehive4py.query module</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>sort</code></td>
<td><code>Array</code></td>
<td>
<p>List of fields to sort the result with. Prefix the field name with <code>-</code> for descending order
and <code>+</code> for ascending order</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>range</code></td>
<td><code>str</code></td>
<td>
<p>A range describing the number of rows to be returned</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON array representing a list of case task logs</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseTaskException</code></td>
<td>
<p>An error occured during case task log search</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>1174
1175
1176
1177
1178
1179
1180
1181
1182
1183
1184
1185
1186
1187
1188
1189
1190
1191</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">find_task_logs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Find task logs using sort, pagination and a query</span>

<span class="sd">    Arguments:</span>
<span class="sd">        query (dict): A query object, defined in JSON format or using utiliy methods from thehive4py.query module</span>
<span class="sd">        sort (Array): List of fields to sort the result with. Prefix the field name with `-` for descending order</span>
<span class="sd">            and `+` for ascending order</span>
<span class="sd">        range (str): A range describing the number of rows to be returned</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON array representing a list of case task logs</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseTaskException: An error occured during case task log search</span>
<span class="sd">    """</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__find_rows</span><span class="p">(</span><span class="s2">"/api/case/task/log/_search"</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.find_tasks">
<code class="highlight language-python">
find_tasks<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.find_tasks" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Find case tasks using sort, pagination and a query</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>query</code></td>
<td><code>dict</code></td>
<td>
<p>A query object, defined in JSON format or using utiliy methods from thehive4py.query module</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>sort</code></td>
<td><code>Array</code></td>
<td>
<p>List of fields to sort the result with. Prefix the field name with <code>-</code> for descending order
and <code>+</code> for ascending order</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>range</code></td>
<td><code>str</code></td>
<td>
<p>A range describing the number of rows to be returned</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON array of case tasks.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AlertException</code></td>
<td>
<p>An error occured during case task search</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>1155
1156
1157
1158
1159
1160
1161
1162
1163
1164
1165
1166
1167
1168
1169
1170
1171
1172</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">find_tasks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Find case tasks using sort, pagination and a query</span>

<span class="sd">    Arguments:</span>
<span class="sd">        query (dict): A query object, defined in JSON format or using utiliy methods from thehive4py.query module</span>
<span class="sd">        sort (Array): List of fields to sort the result with. Prefix the field name with `-` for descending order</span>
<span class="sd">            and `+` for ascending order</span>
<span class="sd">        range (str): A range describing the number of rows to be returned</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON array of case tasks.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AlertException: An error occured during case task search</span>
<span class="sd">    """</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__find_rows</span><span class="p">(</span><span class="s2">"/api/case/task/_search"</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.get_alert">
<code class="highlight language-python">
get_alert<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert_id</span><span class="p">,</span> <span class="n">similar_cases</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.get_alert" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Get an alert by its id</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>alert_id</code></td>
<td><code>str</code></td>
<td>
<p>Id of the alert</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>similar_cases</code></td>
<td><code>bool</code></td>
<td>
<p>True if similar cases should be retrieved (Default False)</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON representation of the alert</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AlertException</code></td>
<td>
<p>An error occured during alert update</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>1007
1008
1009
1010
1011
1012
1013
1014
1015
1016
1017
1018
1019
1020
1021
1022
1023
1024
1025
1026
1027
1028
1029
1030
1031
1032
1033
1034</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_alert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert_id</span><span class="p">,</span> <span class="n">similar_cases</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Get an alert by its id</span>

<span class="sd">    Arguments:</span>
<span class="sd">        alert_id (str): Id of the alert</span>
<span class="sd">        similar_cases (bool): True if similar cases should be retrieved (Default False)</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON representation of the alert</span>

<span class="sd">    Raises:</span>
<span class="sd">        AlertException: An error occured during alert update</span>
<span class="sd">    """</span>

    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/alert/</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alert_id</span><span class="p">)</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">similar_cases</span><span class="p">:</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">"similarity"</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">similar_cases</span><span class="p">)</span>
        <span class="p">}</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">AlertException</span><span class="p">(</span><span class="s2">"Alert fetch error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.get_case">
<code class="highlight language-python">
get_case<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case_id</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.get_case" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Get a case by id</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>case_id</code></td>
<td><code>str</code></td>
<td>
<p>Case identifier</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON description of the case.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseException</code></td>
<td>
<p>An error occured during case fetch</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_case</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case_id</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Get a case by id</span>

<span class="sd">    Arguments:</span>
<span class="sd">        case_id (str): Case identifier</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON description of the case.</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseException: An error occured during case fetch</span>
<span class="sd">    """</span>

    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/case/</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">case_id</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CaseException</span><span class="p">(</span><span class="s2">"Case fetch error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.get_case_observable">
<code class="highlight language-python">
get_case_observable<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observable_id</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.get_case_observable" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Get a case observable by its id</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>observable_id</code></td>
<td><code>str</code></td>
<td>
<p>Case observable identifier</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON representation of the case observable</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseObservableException</code></td>
<td>
<p>An error occured during case observable fetch</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_case_observable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observable_id</span><span class="p">):</span>

    <span class="sd">"""</span>
<span class="sd">    Get a case observable by its id</span>

<span class="sd">    Arguments:</span>
<span class="sd">        observable_id (str): Case observable identifier</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON representation of the case observable</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseObservableException: An error occured during case observable fetch</span>
<span class="sd">    """</span>

    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/case/artifact/</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">observable_id</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CaseObservableException</span><span class="p">(</span><span class="s2">"Case observable search error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.get_case_observables">
<code class="highlight language-python">
get_case_observables<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case_id</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.get_case_observables" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Find observables of a given case identified by its id</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>case_id</code></td>
<td><code>str</code></td>
<td>
<p>Id of the case</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>query</code></td>
<td><code>dict</code></td>
<td>
<p>A query object, defined in JSON format or using utiliy methods from thehive4py.query module</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>sort</code></td>
<td><code>Array</code></td>
<td>
<p>List of fields to sort the result with. Prefix the field name with <code>-</code> for descending order
and <code>+</code> for ascending order</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>range</code></td>
<td><code>str</code></td>
<td>
<p>A range describing the number of rows to be returned</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON array of case observable.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseObservableException</code></td>
<td>
<p>An error occured during case observable search</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_case_observables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case_id</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">):</span>

    <span class="sd">"""</span>
<span class="sd">    Find observables of a given case identified by its id</span>

<span class="sd">    Arguments:</span>
<span class="sd">        case_id (str): Id of the case</span>
<span class="sd">        query (dict): A query object, defined in JSON format or using utiliy methods from thehive4py.query module</span>
<span class="sd">        sort (Array): List of fields to sort the result with. Prefix the field name with `-` for descending order</span>
<span class="sd">            and `+` for ascending order</span>
<span class="sd">        range (str): A range describing the number of rows to be returned</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON array of case observable.</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseObservableException: An error occured during case observable search</span>
<span class="sd">    """</span>

    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/case/artifact/_search"</span>

    <span class="c1"># Add range and sort parameters</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">"range"</span><span class="p">:</span> <span class="n">attributes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"range"</span><span class="p">,</span> <span class="s2">"all"</span><span class="p">),</span>
        <span class="s2">"sort"</span><span class="p">:</span> <span class="n">attributes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"sort"</span><span class="p">,</span> <span class="p">[])</span>
    <span class="p">}</span>

    <span class="c1"># Add body</span>
    <span class="n">parent_criteria</span> <span class="o">=</span> <span class="n">Parent</span><span class="p">(</span><span class="s1">'case'</span><span class="p">,</span> <span class="n">Id</span><span class="p">(</span><span class="n">case_id</span><span class="p">))</span>

    <span class="c1"># Append the custom query if specified</span>
    <span class="k">if</span> <span class="s2">"query"</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">:</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="n">And</span><span class="p">(</span><span class="n">parent_criteria</span><span class="p">,</span> <span class="n">attributes</span><span class="p">[</span><span class="s2">"query"</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="n">parent_criteria</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">"query"</span><span class="p">:</span> <span class="n">criteria</span>
    <span class="p">}</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CaseObservableException</span><span class="p">(</span><span class="s2">"Case observables search error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.get_case_task">
<code class="highlight language-python">
get_case_task<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_id</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.get_case_task" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Get a case task by its id</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>task_id</code></td>
<td><code>str</code></td>
<td>
<p>Case task identifier</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON representation of the case task</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseTaskException</code></td>
<td>
<p>An error occured during case task fetch</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>787
788
789
790
791
792
793
794
795
796
797
798
799
800
801
802
803
804
805</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_case_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_id</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Get a case task by its id</span>

<span class="sd">    Arguments:</span>
<span class="sd">        task_id (str): Case task identifier</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON representation of the case task</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseTaskException: An error occured during case task fetch</span>
<span class="sd">    """</span>

    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/case/task/</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">task_id</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CaseTaskException</span><span class="p">(</span><span class="s2">"Case task logs search error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.get_case_tasks">
<code class="highlight language-python">
get_case_tasks<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case_id</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.get_case_tasks" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Find tasks of a given case identified by its id</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>case_id</code></td>
<td><code>str</code></td>
<td>
<p>Id of the case</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>query</code></td>
<td><code>dict</code></td>
<td>
<p>A query object, defined in JSON format or using utiliy methods from thehive4py.query module</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>sort</code></td>
<td><code>Array</code></td>
<td>
<p>List of fields to sort the result with. Prefix the field name with <code>-</code> for descending order
and <code>+</code> for ascending order</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>range</code></td>
<td><code>str</code></td>
<td>
<p>A range describing the number of rows to be returned</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON array of case task.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseTaskException</code></td>
<td>
<p>An error occured during case task search</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_case_tasks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case_id</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Find tasks of a given case identified by its id</span>

<span class="sd">    Arguments:</span>
<span class="sd">        case_id (str): Id of the case</span>
<span class="sd">        query (dict): A query object, defined in JSON format or using utiliy methods from thehive4py.query module</span>
<span class="sd">        sort (Array): List of fields to sort the result with. Prefix the field name with `-` for descending order</span>
<span class="sd">            and `+` for ascending order</span>
<span class="sd">        range (str): A range describing the number of rows to be returned</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON array of case task.</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseTaskException: An error occured during case task search</span>
<span class="sd">    """</span>

    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/case/task/_search"</span>

    <span class="c1"># Add range and sort parameters</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">"range"</span><span class="p">:</span> <span class="n">attributes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"range"</span><span class="p">,</span> <span class="s2">"all"</span><span class="p">),</span>
        <span class="s2">"sort"</span><span class="p">:</span> <span class="n">attributes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"sort"</span><span class="p">,</span> <span class="p">[])</span>
    <span class="p">}</span>

    <span class="c1"># Add body</span>
    <span class="n">parent_criteria</span> <span class="o">=</span> <span class="n">Parent</span><span class="p">(</span><span class="s1">'case'</span><span class="p">,</span> <span class="n">Id</span><span class="p">(</span><span class="n">case_id</span><span class="p">))</span>

    <span class="c1"># Append the custom query if specified</span>
    <span class="k">if</span> <span class="s2">"query"</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">:</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="n">And</span><span class="p">(</span><span class="n">parent_criteria</span><span class="p">,</span> <span class="n">attributes</span><span class="p">[</span><span class="s2">"query"</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="n">parent_criteria</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">"query"</span><span class="p">:</span> <span class="n">criteria</span>
    <span class="p">}</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CaseTaskException</span><span class="p">(</span><span class="s2">"Case tasks search error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.get_case_template">
<code class="highlight language-python">
get_case_template<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.get_case_template" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Get a case template by its name</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>str</code></td>
<td>
<p>Case template's name</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON representation of the case template</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseTemplateException</code></td>
<td>
<p>An error occured during case template fetch</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>682
683
684
685
686
687
688
689
690
691
692
693
694
695
696
697
698
699
700
701
702
703
704
705
706
707
708
709
710
711
712
713
714
715
716
717</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_case_template</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>

    <span class="sd">"""</span>
<span class="sd">    Get a case template by its name</span>

<span class="sd">    Arguments:</span>
<span class="sd">        name (str): Case template's name</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON representation of the case template</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseTemplateException: An error occured during case template fetch</span>
<span class="sd">    """</span>

    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/case/template/_search"</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isVersion</span><span class="p">(</span><span class="n">Version</span><span class="o">.</span><span class="n">THEHIVE_3</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
        <span class="n">query</span> <span class="o">=</span> <span class="n">And</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="s2">"name"</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span> <span class="n">Eq</span><span class="p">(</span><span class="s2">"status"</span><span class="p">,</span> <span class="s2">"Ok"</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">query</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="s2">"name"</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">"query"</span><span class="p">:</span> <span class="n">query</span>
    <span class="p">}</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
        <span class="n">json_response</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">json_response</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CaseTemplateException</span><span class="p">(</span><span class="s2">"Case template fetch error: Unable to find case template </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CaseTemplateException</span><span class="p">(</span><span class="s2">"Case template fetch error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.get_current_user">
<code class="highlight language-python">
get_current_user<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.get_current_user" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Method to call the /api/current endpoint, returning the current authenticated user.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON description of the current user</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>TheHiveException</code></td>
<td>
<p>Generic exception if an error occurs</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_current_user</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Method to call the /api/current endpoint, returning the current authenticated user.</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON description of the current user</span>

<span class="sd">    Raises:</span>
<span class="sd">        TheHiveException: Generic exception if an error occurs</span>
<span class="sd">    """</span>

    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/user/current"</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">TheHiveException</span><span class="p">(</span><span class="s2">"Error on retrieving current user: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.get_linked_cases">
<code class="highlight language-python">
get_linked_cases<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case_id</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.get_linked_cases" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Find related cases of a given case identified by its id</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>case_id</code></td>
<td><code>str</code></td>
<td>
<p>Id of the case</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON array of related cases.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseException</code></td>
<td>
<p>An error occured during case links fetch</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_linked_cases</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case_id</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Find related cases of a given case identified by its id</span>

<span class="sd">    Arguments:</span>
<span class="sd">        case_id (str): Id of the case</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON array of related cases.</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseException: An error occured during case links fetch</span>
<span class="sd">    """</span>
    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/case/</span><span class="si">{}</span><span class="s2">/links"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">case_id</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CaseException</span><span class="p">(</span><span class="s2">"Linked cases fetch error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.get_task_log">
<code class="highlight language-python">
get_task_log<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_id</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.get_task_log" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Get a case task log by its id</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>log_id</code></td>
<td><code>str</code></td>
<td>
<p>Case task log identifier</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON representation of the case task log</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseTaskException</code></td>
<td>
<p>An error occured during case task log fetch</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>807
808
809
810
811
812
813
814
815
816
817
818
819
820
821
822
823
824
825
826
827
828
829
830
831
832
833
834
835
836
837
838</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_task_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_id</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Get a case task log by its id</span>

<span class="sd">    Arguments:</span>
<span class="sd">        log_id (str): Case task log identifier</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON representation of the case task log</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseTaskException: An error occured during case task log fetch</span>
<span class="sd">    """</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isVersion</span><span class="p">(</span><span class="n">Version</span><span class="o">.</span><span class="n">THEHIVE_3</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
        <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/case/task/log/</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">log_id</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CaseTaskLogException</span><span class="p">(</span><span class="s2">"Case task log fetch error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/v1/query"</span>

        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">"query"</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span><span class="s2">"_name"</span><span class="p">:</span> <span class="s2">"getLog"</span><span class="p">,</span> <span class="s2">"idOrName"</span><span class="p">:</span> <span class="n">log_id</span><span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CaseTaskLogException</span><span class="p">(</span><span class="s2">"Case task log fetch error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.get_task_logs">
<code class="highlight language-python">
get_task_logs<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_id</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.get_task_logs" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Get logs of a case task by its id</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>task_id</code></td>
<td><code>str</code></td>
<td>
<p>Case task identifier</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>query</code></td>
<td><code>dict</code></td>
<td>
<p>A query object, defined in JSON format or using utiliy methods from thehive4py.query module</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>sort</code></td>
<td><code>Array</code></td>
<td>
<p>List of fields to sort the result with. Prefix the field name with <code>-</code> for descending order
and <code>+</code> for ascending order</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>range</code></td>
<td><code>str</code></td>
<td>
<p>A range describing the number of rows to be returned</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON array representing a list of case task logs</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseTaskException</code></td>
<td>
<p>An error occured during case task log search</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>841
842
843
844
845
846
847
848
849
850
851
852
853
854
855
856
857
858
859
860
861
862
863
864
865
866
867
868
869
870
871
872
873
874
875
876
877
878
879
880</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_task_logs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_id</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Get logs of a case task by its id</span>

<span class="sd">    Arguments:</span>
<span class="sd">        task_id (str): Case task identifier</span>
<span class="sd">        query (dict): A query object, defined in JSON format or using utiliy methods from thehive4py.query module</span>
<span class="sd">        sort (Array): List of fields to sort the result with. Prefix the field name with `-` for descending order</span>
<span class="sd">            and `+` for ascending order</span>
<span class="sd">        range (str): A range describing the number of rows to be returned</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON array representing a list of case task logs</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseTaskException: An error occured during case task log search</span>
<span class="sd">    """</span>

    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/case/task/log/_search"</span>

    <span class="c1"># Add range and sort parameters</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">"range"</span><span class="p">:</span> <span class="n">attributes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"range"</span><span class="p">,</span> <span class="s2">"all"</span><span class="p">),</span>
        <span class="s2">"sort"</span><span class="p">:</span> <span class="n">attributes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"sort"</span><span class="p">,</span> <span class="p">[])</span>
    <span class="p">}</span>

    <span class="c1"># Add body</span>
    <span class="n">parent_criteria</span> <span class="o">=</span> <span class="n">Parent</span><span class="p">(</span><span class="s1">'case_task'</span><span class="p">,</span> <span class="n">Id</span><span class="p">(</span><span class="n">task_id</span><span class="p">))</span>

    <span class="c1"># Append the custom query if specified</span>
    <span class="k">if</span> <span class="s2">"query"</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">:</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="n">And</span><span class="p">(</span><span class="n">parent_criteria</span><span class="p">,</span> <span class="n">attributes</span><span class="p">[</span><span class="s2">"query"</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="n">parent_criteria</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">"query"</span><span class="p">:</span> <span class="n">criteria</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_task_logs</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">criteria</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.health">
<code class="highlight language-python">
health<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.health" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Method to call the /api/health endpoint</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>Response object resulting from the API call.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>TheHiveException</code></td>
<td>
<p>Generic exception if an error occurs</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>128
129
130
131
132
133
134
135
136
137
138
139
140
141
142</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">health</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Method to call the /api/health endpoint</span>

<span class="sd">    Returns:</span>
<span class="sd">        Response object resulting from the API call.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TheHiveException: Generic exception if an error occurs</span>
<span class="sd">    """</span>
    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/health"</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">TheHiveException</span><span class="p">(</span><span class="s2">"Error on retrieving health status: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.mark_alert_as_read">
<code class="highlight language-python">
mark_alert_as_read<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert_id</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.mark_alert_as_read" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Mark an alert as read. This sets the status of the alert to <code>Ignored</code> if it's not yet promoted to a case.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>alert_id</code></td>
<td><code>str</code></td>
<td>
<p>Id of the alert</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON representation of the alert</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AlertException</code></td>
<td>
<p>An error occured during alert update</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>913
914
915
916
917
918
919
920
921
922
923
924
925
926
927
928
929
930
931</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">mark_alert_as_read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert_id</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Mark an alert as read. This sets the status of the alert to `Ignored` if it's not yet promoted to a case.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        alert_id (str): Id of the alert</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON representation of the alert</span>

<span class="sd">    Raises:</span>
<span class="sd">        AlertException: An error occured during alert update</span>
<span class="sd">    """</span>
    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/alert/</span><span class="si">{}</span><span class="s2">/markAsRead"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alert_id</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">},</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">AlertException</span><span class="p">(</span><span class="s2">"Mark alert as read error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.mark_alert_as_unread">
<code class="highlight language-python">
mark_alert_as_unread<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert_id</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.mark_alert_as_unread" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Mark an alert as unread. This sets the status of the alert to <code>New</code> if it's not yet promoted to a case.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>alert_id</code></td>
<td><code>str</code></td>
<td>
<p>Id of the alert</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON representation of the alert</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AlertException</code></td>
<td>
<p>An error occured during alert update</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>933
934
935
936
937
938
939
940
941
942
943
944
945
946
947
948
949
950
951</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">mark_alert_as_unread</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert_id</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Mark an alert as unread. This sets the status of the alert to `New` if it's not yet promoted to a case.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        alert_id (str): Id of the alert</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON representation of the alert</span>

<span class="sd">    Raises:</span>
<span class="sd">        AlertException: An error occured during alert update</span>
<span class="sd">    """</span>
    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/alert/</span><span class="si">{}</span><span class="s2">/markAsUnread"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alert_id</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">},</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">AlertException</span><span class="p">(</span><span class="s2">"Mark alert as unread error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.merge_alert_into_case">
<code class="highlight language-python">
merge_alert_into_case<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert_id</span><span class="p">,</span> <span class="n">case_id</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.merge_alert_into_case" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Merge alert into existing case.
:param alert_id: The ID of the alert to merge.
:param case_id: The ID of the case where to merge alert
:return:</p>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>953
954
955
956
957
958
959
960
961
962
963
964
965</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">merge_alert_into_case</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert_id</span><span class="p">,</span> <span class="n">case_id</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Merge alert into existing case.</span>
<span class="sd">    :param alert_id: The ID of the alert to merge.</span>
<span class="sd">    :param case_id: The ID of the case where to merge alert</span>
<span class="sd">    :return:</span>
<span class="sd">    """</span>
    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/alert/</span><span class="si">{}</span><span class="s2">/merge/</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alert_id</span><span class="p">,</span> <span class="n">case_id</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">},</span> <span class="n">json</span><span class="o">=</span><span class="p">{},</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">AlertException</span><span class="p">(</span><span class="s2">"Merge alert to case error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.promote_alert_to_case">
<code class="highlight language-python">
promote_alert_to_case<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert_id</span><span class="p">,</span> <span class="n">case_template</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.promote_alert_to_case" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Create a new case from an alert, with an optional case template</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>alert_id</code></td>
<td><code>str</code></td>
<td>
<p>Id of the alert</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>case_template</code></td>
<td><code>str</code></td>
<td>
<p>Case template name to apply when creating the cas</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON representation of the alert</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AlertException</code></td>
<td>
<p>An error occured during alert promotion</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>1101
1102
1103
1104
1105
1106
1107
1108
1109
1110
1111
1112
1113
1114
1115
1116
1117
1118
1119
1120
1121
1122
1123
1124
1125
1126</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">promote_alert_to_case</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert_id</span><span class="p">,</span> <span class="n">case_template</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Create a new case from an alert, with an optional case template</span>

<span class="sd">    Arguments:</span>
<span class="sd">        alert_id (str): Id of the alert</span>
<span class="sd">        case_template (str): Case template name to apply when creating the cas</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON representation of the alert</span>

<span class="sd">    Raises:</span>
<span class="sd">        AlertException: An error occured during alert promotion</span>
<span class="sd">    """</span>

    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/alert/</span><span class="si">{}</span><span class="s2">/createCase"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alert_id</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">},</span>
                             <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span>
                             <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">"caseTemplate"</span><span class="p">:</span> <span class="n">case_template</span><span class="p">}))</span>

    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">the_exception</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">AlertException</span><span class="p">(</span><span class="s2">"Couldn't promote alert to case: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">the_exception</span><span class="p">))</span>

    <span class="k">return</span> <span class="kc">None</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.run_analyzer">
<code class="highlight language-python">
run_analyzer<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cortex_id</span><span class="p">,</span> <span class="n">artifact_id</span><span class="p">,</span> <span class="n">analyzer_id</span><span class="p">)</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.run_analyzer" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Create a new case from an alert, with an optional case template</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>cortex_id</code></td>
<td><code></code></td>
<td>
<p>identifier of the Cortex server</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>artifact_id</code></td>
<td><code></code></td>
<td>
<p>identifier of the artifact as found with an artifact search</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>analyzer_id</code></td>
<td><code></code></td>
<td>
<p>name of the analyzer used by the job</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON representation of the analysis job</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>TheHiveException</code></td>
<td>
<p>An error occured during job creation</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>1128
1129
1130
1131
1132
1133
1134
1135
1136
1137
1138
1139
1140
1141
1142
1143
1144
1145
1146
1147
1148
1149
1150
1151
1152
1153</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">run_analyzer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cortex_id</span><span class="p">,</span> <span class="n">artifact_id</span><span class="p">,</span> <span class="n">analyzer_id</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Create a new case from an alert, with an optional case template</span>

<span class="sd">    Arguments:</span>
<span class="sd">        cortex_id: identifier of the Cortex server</span>
<span class="sd">        artifact_id: identifier of the artifact as found with an artifact search</span>
<span class="sd">        analyzer_id: name of the analyzer used by the job</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON representation of the analysis job</span>

<span class="sd">    Raises:</span>
<span class="sd">        TheHiveException: An error occured during job creation</span>
<span class="sd">    """</span>

    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/connector/cortex/job"</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span> <span class="s2">"cortexId"</span><span class="p">:</span> <span class="n">cortex_id</span><span class="p">,</span>
            <span class="s2">"artifactId"</span><span class="p">:</span> <span class="n">artifact_id</span><span class="p">,</span>
            <span class="s2">"analyzerId"</span><span class="p">:</span> <span class="n">analyzer_id</span>
            <span class="p">})</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">},</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">TheHiveException</span><span class="p">(</span><span class="s2">"Analyzer run error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.update_alert">
<code class="highlight language-python">
update_alert<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert_id</span><span class="p">,</span> <span class="n">alert</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[])</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.update_alert" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Update an alert completely or using specified fields</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>alert_id</code></td>
<td><code>str</code></td>
<td>
<p>Id of the alert</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>alert</code></td>
<td><code>Alert</code></td>
<td>
<p>Instance of <a href="https://thehive-project.github.io/thehive4py/reference/models/#thehive4py.models.Alert">Alert</a></p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>fields</code></td>
<td><code>Array</code></td>
<td>
<p>Optional parameter, an array of field names, the ones we want to update</p>
<p>Updatable fields are: [<code>tlp</code>, <code>severity</code>, <code>tags</code>, <code>caseTemplate</code>, <code>title</code>, <code>description</code>, <code>customFields</code>]</p>
</td>
<td><code>[]</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON representation of the alert</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AlertException</code></td>
<td>
<p>An error occured during alert update</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span> 967
 968
 969
 970
 971
 972
 973
 974
 975
 976
 977
 978
 979
 980
 981
 982
 983
 984
 985
 986
 987
 988
 989
 990
 991
 992
 993
 994
 995
 996
 997
 998
 999
1000
1001
1002
1003
1004
1005</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">update_alert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert_id</span><span class="p">,</span> <span class="n">alert</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">"""</span>
<span class="sd">    Update an alert completely or using specified fields</span>

<span class="sd">    Arguments:</span>
<span class="sd">        alert_id (str): Id of the alert</span>
<span class="sd">        alert (Alert): Instance of [Alert][thehive4py.models.Alert]</span>
<span class="sd">        fields (Array): Optional parameter, an array of field names, the ones we want to update</span>

<span class="sd">            Updatable fields are: [`tlp`, `severity`, `tags`, `caseTemplate`, `title`, `description`, `customFields`]</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON representation of the alert</span>

<span class="sd">    Raises:</span>
<span class="sd">        AlertException: An error occured during alert update</span>
<span class="sd">    """</span>
    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/alert/</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alert_id</span><span class="p">)</span>

    <span class="c1"># update only the alert attributes that are not read-only</span>
    <span class="n">update_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'tlp'</span><span class="p">,</span> <span class="s1">'pap'</span><span class="p">,</span> <span class="s1">'severity'</span><span class="p">,</span> <span class="s1">'tags'</span><span class="p">,</span> <span class="s1">'caseTemplate'</span><span class="p">,</span> <span class="s1">'title'</span><span class="p">,</span> <span class="s1">'description'</span><span class="p">,</span> <span class="s1">'customFields'</span><span class="p">,</span>
                   <span class="s1">'artifacts'</span><span class="p">,</span> <span class="s1">'follow'</span><span class="p">]</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">alert</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">update_keys</span><span class="p">)}</span>

    <span class="k">if</span> <span class="s1">'artifacts'</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">'artifacts'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="vm">__dict__</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">alert</span><span class="o">.</span><span class="n">artifacts</span><span class="p">]</span>
        <span class="c1"># data['artifacts'] = [{k: v for k, v in a.__dict__.items()} for a in alert.artifacts]</span>

    <span class="c1"># Exclude PAP field for TheHive 3</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isVersion</span><span class="p">(</span><span class="n">Version</span><span class="o">.</span><span class="n">THEHIVE_3</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
        <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">'pap'</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">'externalLink'</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">},</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">AlertException</span><span class="p">(</span><span class="s2">"Alert update error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.update_alert_artifact">
<code class="highlight language-python">
update_alert_artifact<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">artifact_id</span><span class="p">,</span> <span class="n">alert_artifact</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[])</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.update_alert_artifact" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Update an existing alert artifact</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>artifact_id</code></td>
<td><code></code></td>
<td>
<p>Artifact identifier</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>alert_artifact</code></td>
<td><code>AlertArtifact</code></td>
<td>
<p>Instance of <a href="https://thehive-project.github.io/thehive4py/reference/models/#thehive4py.models.AlertArtifact">AlertArtifact</a></p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>fields</code></td>
<td><code>Array</code></td>
<td>
<p>Optional parameter, an array of fields names, the ones we want to update.</p>
<p>Updatable fields are: [<code>tlp</code>, <code>ioc</code>, <code>sighted</code>, <code>tags</code>, <code>message</code>, <code>ignoreSimilarity</code>]</p>
</td>
<td><code>[]</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON description of the updated alert artifact</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AlertArtifactException</code></td>
<td>
<p>An error occured during alert artifact update</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function is available in TheHive 4 ONLY</p>
</div>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>1374
1375
1376
1377
1378
1379
1380
1381
1382
1383
1384
1385
1386
1387
1388
1389
1390
1391
1392
1393
1394
1395
1396
1397
1398
1399
1400
1401
1402
1403
1404
1405
1406
1407
1408
1409</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">update_alert_artifact</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">artifact_id</span><span class="p">,</span> <span class="n">alert_artifact</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[]):</span>

    <span class="sd">"""</span>
<span class="sd">    Update an existing alert artifact</span>

<span class="sd">    Arguments:</span>
<span class="sd">        artifact_id: Artifact identifier</span>
<span class="sd">        alert_artifact (AlertArtifact): Instance of [AlertArtifact][thehive4py.models.AlertArtifact]</span>
<span class="sd">        fields (Array): Optional parameter, an array of fields names, the ones we want to update.</span>

<span class="sd">            Updatable fields are: [`tlp`, `ioc`, `sighted`, `tags`, `message`, `ignoreSimilarity`]</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON description of the updated alert artifact</span>

<span class="sd">    Raises:</span>
<span class="sd">        AlertArtifactException: An error occured during alert artifact update</span>

<span class="sd">    !!! Warning</span>
<span class="sd">        This function is available in TheHive 4 ONLY</span>
<span class="sd">    """</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isVersion</span><span class="p">(</span><span class="n">Version</span><span class="o">.</span><span class="n">THEHIVE_3</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">AlertArtifactException</span><span class="p">(</span><span class="s2">"This function is available in TheHive 4 ONLY"</span><span class="p">)</span>

    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/alert/artifact/</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">artifact_id</span><span class="p">)</span>

    <span class="n">update_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'message'</span><span class="p">,</span> <span class="s1">'tlp'</span><span class="p">,</span> <span class="s1">'tags'</span><span class="p">,</span> <span class="s1">'ioc'</span><span class="p">,</span> <span class="s1">'sighted'</span><span class="p">,</span> <span class="s1">'ignoreSimilarity'</span><span class="p">]</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">alert_artifact</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">update_keys</span><span class="p">)}</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">},</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CaseObservableException</span><span class="p">(</span><span class="s2">"Case observable update error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.update_case">
<code class="highlight language-python">
update_case<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[])</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.update_case" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Update a case.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>case</code></td>
<td><code>Case</code></td>
<td>
<p>Instance of <a href="https://thehive-project.github.io/thehive4py/reference/models/#thehive4py.models.Case">Case</a> to update. The case's <code>id</code> determines which case to update.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>fields</code></td>
<td><code>Array</code></td>
<td>
<p>Optional parameter, an array of fields names, the ones we want to update</p>
<p>Updatable fields are: [<code>title</code>, <code>description</code>, <code>severity</code>, <code>startDate</code>, <code>owner</code>, <code>flag</code>, <code>tlp</code>, <code>pap</code>, <code>tags</code>, <code>status</code>,
<code>resolutionStatus</code>, <code>impactStatus</code>, <code>summary</code>, <code>endDate</code>, <code>metrics</code>, <code>customFields</code>]</p>
</td>
<td><code>[]</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON description of a case</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseException</code></td>
<td>
<p>An error occured during case creation</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">update_case</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">case</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">"""</span>
<span class="sd">    Update a case.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        case (Case): Instance of [Case][thehive4py.models.Case] to update. The case's `id` determines which case to update.</span>
<span class="sd">        fields (Array): Optional parameter, an array of fields names, the ones we want to update</span>

<span class="sd">            Updatable fields are: [`title`, `description`, `severity`, `startDate`, `owner`, `flag`, `tlp`, `pap`, `tags`, `status`,</span>
<span class="sd">            `resolutionStatus`, `impactStatus`, `summary`, `endDate`, `metrics`, `customFields`]</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON description of a case</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseException: An error occured during case creation</span>
<span class="sd">    """</span>
    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/case/</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

    <span class="c1"># Choose which attributes to send</span>
    <span class="n">update_keys</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">'title'</span><span class="p">,</span> <span class="s1">'description'</span><span class="p">,</span> <span class="s1">'severity'</span><span class="p">,</span> <span class="s1">'startDate'</span><span class="p">,</span> <span class="s1">'owner'</span><span class="p">,</span> <span class="s1">'flag'</span><span class="p">,</span> <span class="s1">'tlp'</span><span class="p">,</span> <span class="s1">'pap'</span><span class="p">,</span> <span class="s1">'tags'</span><span class="p">,</span> <span class="s1">'status'</span><span class="p">,</span>
        <span class="s1">'resolutionStatus'</span><span class="p">,</span> <span class="s1">'impactStatus'</span><span class="p">,</span> <span class="s1">'summary'</span><span class="p">,</span> <span class="s1">'endDate'</span><span class="p">,</span> <span class="s1">'metrics'</span><span class="p">,</span> <span class="s1">'customFields'</span>
    <span class="p">]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">case</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">update_keys</span><span class="p">)}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">},</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CaseException</span><span class="p">(</span><span class="s2">"Case update error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.update_case_observable">
<code class="highlight language-python">
update_case_observable<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observable_id</span><span class="p">,</span> <span class="n">case_observable</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[])</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.update_case_observable" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Update an existing case observable</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>observable_id</code></td>
<td><code></code></td>
<td>
<p>Observable identifier</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>case_observable</code></td>
<td><code>CaseObservable</code></td>
<td>
<p>Instance of <a href="https://thehive-project.github.io/thehive4py/reference/models/#thehive4py.models.CaseObservable">CaseObservable</a></p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>fields</code></td>
<td><code>Array</code></td>
<td>
<p>Optional parameter, an array of fields names, the ones we want to update.</p>
<p>Updatable fields are: [<code>tlp</code>, <code>ioc</code>, <code>sighted</code>, <code>tags</code>, <code>message</code>, <code>ignoreSimilarity</code>]</p>
</td>
<td><code>[]</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON description of the updated case observable</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseObservableException</code></td>
<td>
<p>An error occured during case observable update</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">update_case_observable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observable_id</span><span class="p">,</span> <span class="n">case_observable</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[]):</span>

    <span class="sd">"""</span>
<span class="sd">    Update an existing case observable</span>

<span class="sd">    Arguments:</span>
<span class="sd">        observable_id: Observable identifier</span>
<span class="sd">        case_observable (CaseObservable): Instance of [CaseObservable][thehive4py.models.CaseObservable]</span>
<span class="sd">        fields (Array): Optional parameter, an array of fields names, the ones we want to update.</span>

<span class="sd">            Updatable fields are: [`tlp`, `ioc`, `sighted`, `tags`, `message`, `ignoreSimilarity`]</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON description of the updated case observable</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseObservableException: An error occured during case observable update</span>
<span class="sd">    """</span>

    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/case/artifact/</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">observable_id</span><span class="p">)</span>

    <span class="n">update_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'message'</span><span class="p">,</span> <span class="s1">'tlp'</span><span class="p">,</span> <span class="s1">'tags'</span><span class="p">,</span> <span class="s1">'ioc'</span><span class="p">,</span> <span class="s1">'sighted'</span><span class="p">,</span> <span class="s1">'ignoreSimilarity'</span><span class="p">]</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">case_observable</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">update_keys</span><span class="p">)}</span>

    <span class="c1"># Exclude ignoreSimilarity field for TheHive 3</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isVersion</span><span class="p">(</span><span class="n">Version</span><span class="o">.</span><span class="n">THEHIVE_3</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
        <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">'ignoreSimilarity'</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">},</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CaseObservableException</span><span class="p">(</span><span class="s2">"Case observable update error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.update_case_observables">
<code class="highlight language-python">
update_case_observables<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observable</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[])</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.update_case_observables" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>[DEPRECATED] Update a case observable</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>observable</code></td>
<td><code>CaseObservable</code></td>
<td>
<p>Instance of <a href="https://thehive-project.github.io/thehive4py/reference/models/#thehive4py.models.CaseObservable">CaseObservable</a> to update. 
The observable's <code>id</code> determines which case to update.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>fields</code></td>
<td><code>Array</code></td>
<td>
<p>Optional parameter, an array of fields names, the ones we want to update.</p>
<p>Updatable fields are: [<code>tlp</code>, <code>ioc</code>, <code>sighted</code>, <code>tags</code>, <code>message</code>, <code>ignoreSimilarity</code>]</p>
</td>
<td><code>[]</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON description of a case observable</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseObservableException</code></td>
<td>
<p>An error occured during observable update</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>1082
1083
1084
1085
1086
1087
1088
1089
1090
1091
1092
1093
1094
1095
1096
1097
1098
1099</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">update_case_observables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observable</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">"""</span>
<span class="sd">    [DEPRECATED] Update a case observable</span>

<span class="sd">    Arguments:</span>
<span class="sd">        observable (CaseObservable): Instance of [CaseObservable][thehive4py.models.CaseObservable] to update. </span>
<span class="sd">            The observable's `id` determines which case to update.</span>
<span class="sd">        fields (Array): Optional parameter, an array of fields names, the ones we want to update.</span>

<span class="sd">            Updatable fields are: [`tlp`, `ioc`, `sighted`, `tags`, `message`, `ignoreSimilarity`]</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON description of a case observable</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseObservableException: An error occured during observable update</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_case_observable</span><span class="p">(</span><span class="n">observable</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">observable</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="n">fields</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="thehive4py.api.TheHiveApi.update_case_task">
<code class="highlight language-python">
update_case_task<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[])</span> </code>
<a class="headerlink" href="#thehive4py.api.TheHiveApi.update_case_task" title="Permanent link">#</a></h3>
<div class="doc doc-contents">
<p>Update a case task</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>task</code></td>
<td><code>CaseTask</code></td>
<td>
<p>Instance of <a href="https://thehive-project.github.io/thehive4py/reference/models/#thehive4py.models.CaseTask">CaseTask</a></p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>fields</code></td>
<td><code>array</code></td>
<td>
<p>Arry of strings representing CaseTask properties to be updated</p>
<p>Updatable fields are: [<code>title</code>, <code>description</code>, <code>status</code>, <code>order</code>, <code>user</code>, <code>owner</code>, <code>flag</code>, <code>endDate</code>]</p>
</td>
<td><code>[]</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response (requests.Response)</code></td>
<td>
<p>Response object including a JSON description of a case task</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CaseTaskException</code></td>
<td>
<p>An error occured during case task creation</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>thehive4py/api.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">update_case_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">"""</span>
<span class="sd">    Update a case task</span>

<span class="sd">    Arguments:</span>
<span class="sd">        task (CaseTask): Instance of [CaseTask][thehive4py.models.CaseTask]</span>
<span class="sd">        fields (array): Arry of strings representing CaseTask properties to be updated</span>

<span class="sd">            Updatable fields are: [`title`, `description`, `status`, `order`, `user`, `owner`, `flag`, `endDate`]</span>

<span class="sd">    Returns:</span>
<span class="sd">        response (requests.Response): Response object including a JSON description of a case task</span>

<span class="sd">    Raises:</span>
<span class="sd">        CaseTaskException: An error occured during case task creation</span>
<span class="sd">    """</span>

    <span class="n">req</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s2">"/api/case/task/</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">task</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

    <span class="c1"># Choose which attributes to send</span>
    <span class="n">update_keys</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">'title'</span><span class="p">,</span> <span class="s1">'description'</span><span class="p">,</span> <span class="s1">'status'</span><span class="p">,</span> <span class="s1">'order'</span><span class="p">,</span> <span class="s1">'user'</span><span class="p">,</span> <span class="s1">'owner'</span><span class="p">,</span> <span class="s1">'flag'</span><span class="p">,</span> <span class="s1">'endDate'</span>
    <span class="p">]</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">task</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">update_keys</span><span class="p">)}</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">},</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                              <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CaseTaskException</span><span class="p">(</span><span class="s2">"Case task update error: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr/>
<div class="md-source-date">
<small>
    
      Last update: June 2, 2020 07:16:07
    
  </small>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav aria-label="Footer" class="md-footer-nav__inner md-grid">
<a class="md-footer-nav__link md-footer-nav__link--prev" href="../auth/" rel="prev" title="Auth">
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                Auth
              </div>
</div>
</a>
<a class="md-footer-nav__link md-footer-nav__link--next" href="../query/" rel="next" title="Query">
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Next
                </span>
                Query
              </div>
</div>
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a>
</div>
<div class="md-footer-social">
<a class="md-footer-social__link" href="https://www.thehive-project.org" rel="noopener" target="_blank" title="www.thehive-project.org">
<svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><path d="M280.37 148.26L96 300.11V464a16 16 0 0016 16l112.06-.29a16 16 0 0015.92-16V368a16 16 0 0116-16h64a16 16 0 0116 16v95.64a16 16 0 0016 16.05L464 480a16 16 0 0016-16V300L295.67 148.26a12.19 12.19 0 00-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 00-12-12h-56a12 12 0 00-12 12v72.61L318.47 43a48 48 0 00-61 0L4.34 251.47a12 12 0 00-1.6 16.9l25.5 31A12 12 0 0045.15 301l235.22-193.74a12.19 12.19 0 0115.3 0L530.9 301a12 12 0 0016.9-1.6l25.5-31a12 12 0 00-1.7-16.93z"></path></svg>
</a>
<a class="md-footer-social__link" href="https://blog.thehive-project.org" rel="noopener" target="_blank" title="blog.thehive-project.org">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M61.7 169.4l101.5 278C92.2 413 43.3 340.2 43.3 256c0-30.9 6.6-60.1 18.4-86.6zm337.9 75.9c0-26.3-9.4-44.5-17.5-58.7-10.8-17.5-20.9-32.4-20.9-49.9 0-19.6 14.8-37.8 35.7-37.8.9 0 1.8.1 2.8.2-37.9-34.7-88.3-55.9-143.7-55.9-74.3 0-139.7 38.1-177.8 95.9 5 .2 9.7.3 13.7.3 22.2 0 56.7-2.7 56.7-2.7 11.5-.7 12.8 16.2 1.4 17.5 0 0-11.5 1.3-24.3 2l77.5 230.4L249.8 247l-33.1-90.8c-11.5-.7-22.3-2-22.3-2-11.5-.7-10.1-18.2 1.3-17.5 0 0 35.1 2.7 56 2.7 22.2 0 56.7-2.7 56.7-2.7 11.5-.7 12.8 16.2 1.4 17.5 0 0-11.5 1.3-24.3 2l76.9 228.7 21.2-70.9c9-29.4 16-50.5 16-68.7zm-139.9 29.3l-63.8 185.5c19.1 5.6 39.2 8.7 60.1 8.7 24.8 0 48.5-4.3 70.6-12.1-.6-.9-1.1-1.9-1.5-2.9l-65.4-179.2zm183-120.7c.9 6.8 1.4 14 1.4 21.9 0 21.6-4 45.8-16.2 76.2l-65 187.9C426.2 403 468.7 334.5 468.7 256c0-37-9.4-71.8-26-102.1zM504 256c0 136.8-111.3 248-248 248C119.2 504 8 392.7 8 256 8 119.2 119.2 8 256 8c136.7 0 248 111.2 248 248zm-11.4 0c0-130.5-106.2-236.6-236.6-236.6C125.5 19.4 19.4 125.5 19.4 256S125.6 492.6 256 492.6c130.5 0 236.6-106.1 236.6-236.6z"></path></svg>
</a>
<a class="md-footer-social__link" href="https://twitter.com/TheHive_Project" rel="noopener" target="_blank" title="twitter.com">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg>
</a>
<a class="md-footer-social__link" href="https://github.com/TheHive-Project" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</a>
<a class="md-footer-social__link" href="https://gitter.im/TheHive-Project/TheHive" rel="noopener" target="_blank" title="gitter.im">
<svg viewbox="0 0 384 512" xmlns="http://www.w3.org/2000/svg"><path d="M66.4 322.5H16V0h50.4v322.5zM166.9 76.1h-50.4V512h50.4V76.1zm100.6 0h-50.4V512h50.4V76.1zM368 76h-50.4v247H368V76z"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<script src="../../assets/javascripts/vendor.d710d30a.min.js"></script>
<script src="../../assets/javascripts/bundle.5f27aba8.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
<script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.27c6a5e6.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
</body>
</html>